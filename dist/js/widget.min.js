if("undefined"==typeof config){var config={};"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json")}var RiseVision=RiseVision||{};RiseVision.WebPage={},RiseVision.WebPage=function(e,t){"use strict";function n(){var t,n,i,o=e.getElementById("webpage-container"),a=e.getElementById("webpage-frame"),r=g.getInt("rsH")/g.getInt("rsW")*100,s=d.scrollHorizontal>0?d.scrollHorizontal:0,l=d.scrollVertical>0?d.scrollVertical:0,c=parseFloat(d.zoom);o&&a&&(t=o.getElementsByClassName("blocker")[0],o.style.visibility="hidden",0!==l&&(r+=l/g.getInt("rsW")*100),o.setAttribute("style","padding-bottom:"+r+"%"),t.style.display=d.interactive?"none":"block",a.setAttribute("scrolling",d.scrollbars?"yes":"no"),n="-ms-zoom:"+c+";-moz-transform: scale("+c+");-moz-transform-origin: 0 0;-o-transform: scale("+c+");-o-transform-origin: 0 0;-webkit-transform: scale("+c+");-webkit-transform-origin: 0 0;",n+="width: "+1/c*100+"%;height: "+1/c*100+"%;",a.setAttribute("style",n),(0!==s||0!==l)&&(i="margin: -"+l+"px 0 0 -"+s+"px;",a.setAttribute("style",n+i)))}function i(){var t=e.getElementById("webpage-frame"),n=e.getElementById("webpage-container"),o=/[?#&]/.test(m),a=Math.ceil(100*Math.random()),r=o?m+"&dummyVar="+a:m+"?dummyVar="+a;n&&t&&(t.onload=function(){t.onload=null,n.style.visibility="visible",d.refresh>0&&null===f&&(f=setInterval(function(){i()},d.refresh))},t.setAttribute("src",r))}function o(){var t=e.getElementById("webpage-frame");d.refresh>0&&clearInterval(f),t&&(t.src="about:blank")}function a(){t.rpc.call("","rsevent_ready",null,g.getString("id"),!0,!0,!0,!0,!1)}function r(){m=d.url,-1===m.indexOf("://")&&(m="http://"+m),n(),a()}function s(){o()}function l(){i()}function c(){o()}function u(e){g=new t.Prefs,d=e,b=new RiseVision.Common.Background(d),b.init(r)}var g=null,d={},m="",f=null,b=null;return{setAdditionalParams:u,pause:s,play:l,stop:c}}(document,gadgets);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Background=function(e){"use strict";function t(){setTimeout(function(){s.style.backgroundImage="url("+e.background.image.url+g+"cb="+(new Date).getTime()+")",t()},c)}function n(){r=!0,e.background.useImage&&!u&&t(),a&&"function"==typeof a&&a()}function i(){var t;s=document.getElementById("background"),l=document.getElementById("backgroundStorage"),document.body.style.background=e.background.color,s?e.background.useImage?(s.className=e.background.image.position,s.className=e.background.image.scale?s.className+" scale-to-fit":s.className,u=0!==Object.keys(e.backgroundStorage).length,u?l?(l.addEventListener("rise-storage-response",function(e){e.detail&&e.detail.files&&e.detail.files.length>0&&(s.style.backgroundImage="url("+e.detail.files[0].url+")"),r||n()}),l.setAttribute("folder",e.backgroundStorage.folder),l.setAttribute("fileName",e.backgroundStorage.fileName),l.setAttribute("companyId",e.backgroundStorage.companyId),l.go()):console.log("Missing element with id value of 'backgroundStorage'"):(t=e.background.image.url.split("?"),g=1===t.length?"?":"&",s.style.backgroundImage="url("+e.background.image.url+")",n())):n():console.log("Missing element with id value of 'background'")}function o(e){r?e&&"function"==typeof e&&e():(e&&(a=e),i())}var a=null,r=!1,s=null,l=null,c=9e5,u=!1,g="";return{init:o}},function(e,t){"use strict";function n(){RiseVision.WebPage.play()}function i(){RiseVision.WebPage.pause()}function o(){RiseVision.WebPage.stop()}function a(e,t){Array.isArray(e)&&e.length>0&&"additionalParams"===e[0]&&Array.isArray(t)&&t.length>0&&RiseVision.WebPage.setAdditionalParams(JSON.parse(t[0]))}var r=new t.Prefs,s=r.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("polymer-ready",function(){s&&""!==s&&(t.rpc.register("rscmd_play_"+s,n),t.rpc.register("rscmd_pause_"+s,i),t.rpc.register("rscmd_stop_"+s,o),t.rpc.register("rsparam_set_"+s,a),t.rpc.call("","rsparam_get",null,s,["additionalParams"]))})}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-6"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiUmlzZVZpc2lvbiIsIldlYlBhZ2UiLCJkb2N1bWVudCIsImdhZGdldHMiLCJfY29uZmlndXJlUGFnZSIsImJsb2NrZXIiLCJ6b29tU3R5bGUiLCJtYXJnaW5TdHlsZSIsImNvbnRhaW5lciIsImdldEVsZW1lbnRCeUlkIiwiZnJhbWUiLCJhc3BlY3RSYXRpbyIsIl9wcmVmcyIsImdldEludCIsInNjcm9sbEhvcml6VmFsIiwiX2FkZGl0aW9uYWxQYXJhbXMiLCJzY3JvbGxIb3Jpem9udGFsIiwic2Nyb2xsVmVydFZhbCIsInNjcm9sbFZlcnRpY2FsIiwiem9vbSIsInBhcnNlRmxvYXQiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwic3R5bGUiLCJ2aXNpYmlsaXR5Iiwic2V0QXR0cmlidXRlIiwiZGlzcGxheSIsIl9sb2FkRnJhbWUiLCJoYXNQYXJhbXMiLCJ0ZXN0IiwiX3VybCIsInJhbmRvbU51bSIsIk1hdGgiLCJjZWlsIiwicmFuZG9tIiwicmVmcmVzaFVSTCIsIm9ubG9hZCIsInJlZnJlc2giLCJfaW50ZXJ2YWxJZCIsInNldEludGVydmFsIiwiX3VubG9hZEZyYW1lIiwiY2xlYXJJbnRlcnZhbCIsInNyYyIsIl9yZWFkeSIsInJwYyIsImNhbGwiLCJnZXRTdHJpbmciLCJfYmFja2dyb3VuZFJlYWR5IiwidXJsIiwiaW5kZXhPZiIsInBhdXNlIiwicGxheSIsInN0b3AiLCJzZXRBZGRpdGlvbmFsUGFyYW1zIiwicGFyYW1zIiwiUHJlZnMiLCJfYmFja2dyb3VuZCIsIkNvbW1vbiIsIkJhY2tncm91bmQiLCJpbml0IiwiZGF0YSIsIl9yZWZyZXNoVGltZXIiLCJzZXRUaW1lb3V0IiwiYmFja2dyb3VuZEltYWdlIiwiYmFja2dyb3VuZCIsImltYWdlIiwiX3NlcGFyYXRvciIsIkRhdGUiLCJnZXRUaW1lIiwiX3JlZnJlc2hEdXJhdGlvbiIsInVzZUltYWdlIiwiX2lzU3RvcmFnZUZpbGUiLCJfY2FsbGJhY2siLCJfY29uZmlndXJlIiwic3RyIiwiX3N0b3JhZ2UiLCJib2R5IiwiY29sb3IiLCJjbGFzc05hbWUiLCJwb3NpdGlvbiIsInNjYWxlIiwiT2JqZWN0Iiwia2V5cyIsImJhY2tncm91bmRTdG9yYWdlIiwibGVuZ3RoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJkZXRhaWwiLCJmaWxlcyIsImZvbGRlciIsImZpbGVOYW1lIiwiY29tcGFueUlkIiwiZ28iLCJjb25zb2xlIiwibG9nIiwic3BsaXQiLCJjYiIsIndpbmRvdyIsImFkZGl0aW9uYWxQYXJhbXMiLCJuYW1lcyIsInZhbHVlcyIsIkFycmF5IiwiaXNBcnJheSIsIkpTT04iLCJwYXJzZSIsInByZWZzIiwiaWQiLCJvbmNvbnRleHRtZW51IiwicmVnaXN0ZXIiLCJfZ2FxIiwicHVzaCIsImdhIiwiY3JlYXRlRWxlbWVudCIsInR5cGUiLCJhc3luYyIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIl0sIm1hcHBpbmdzIjoiQUFFQSxHQUFzQixtQkFBWEEsUUFBd0IsQ0FDakMsR0FBSUEsVUFJbUIsb0JBQVpDLFVBQ1RBLFFBQVFDLE9BQU8sb0NBQ1pDLFNBQVMsaUJBQWtCLHdCQUMzQkEsU0FBUyxnQkFBaUIsU0FNakMsR0FBSUMsWUFBYUEsY0FDakJBLFlBQVdDLFdBRVhELFdBQVdDLFFBQVUsU0FBV0MsRUFBVUMsR0FFeEMsWUFhQSxTQUFTQyxLQUNQLEdBUUVDLEdBQVNDLEVBQVdDLEVBUmxCQyxFQUFZTixFQUFTTyxlQUFlLHFCQUN0Q0MsRUFBUVIsRUFBU08sZUFBZSxpQkFDaENFLEVBQWdCQyxFQUFPQyxPQUFPLE9BQVNELEVBQU9DLE9BQU8sT0FBVSxJQUMvREMsRUFBa0JDLEVBQWtCQyxpQkFBbUIsRUFDbkRELEVBQWtCQyxpQkFBbUIsRUFDekNDLEVBQWlCRixFQUFr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LEdBQUlsSCxTQUFTbUgscUJBQXFCLFVBQVUsRUFBSUQsR0FBRUUsV0FBV0MsYUFBYVQsRUFBSU0iLCJmaWxlIjoianMvd2lkZ2V0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBjb25maWc6IHRydWUgKi9cbi8qIGV4cG9ydGVkIGNvbmZpZyAqL1xuaWYgKHR5cGVvZiBjb25maWcgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICAvLyB2YXJpYWJsZXMgZ28gaGVyZVxuICB9O1xuXG4gIGlmICh0eXBlb2YgYW5ndWxhciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGFuZ3VsYXIubW9kdWxlKFwicmlzZXZpc2lvbi5jb21tb24uaTE4bi5jb25maWdcIiwgW10pXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1BSRUZJWFwiLCBcImxvY2FsZXMvdHJhbnNsYXRpb25fXCIpXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1NVRklYXCIsIFwiLmpzb25cIik7XG4gIH1cbn1cblxuLyogZ2xvYmFsIGdhZGdldHMgKi9cblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5XZWJQYWdlID0ge307XG5cblJpc2VWaXNpb24uV2ViUGFnZSA9IChmdW5jdGlvbiAoZG9jdW1lbnQsIGdhZGdldHMpIHtcblxuICBcInVzZSBzdHJpY3RcIjtcblxuICAvLyBwcml2YXRlIHZhcmlhYmxlc1xuICB2YXIgX3ByZWZzID0gbnVsbCxcbiAgICBfYWRkaXRpb25hbFBhcmFtcyA9IHt9LFxuICAgIF91cmwgPSBcIlwiLFxuICAgIF9pbnRlcnZhbElkID0gbnVsbCxcbiAgICBfYmFja2dyb3VuZCA9IG51bGw7XG5cbiAgLypcbiAgICogIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cblxuICBmdW5jdGlvbiBfY29uZmlndXJlUGFnZSgpIHtcbiAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3ZWJwYWdlLWNvbnRhaW5lclwiKSxcbiAgICAgIGZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3ZWJwYWdlLWZyYW1lXCIpLFxuICAgICAgYXNwZWN0UmF0aW8gPSAgKF9wcmVmcy5nZXRJbnQoXCJyc0hcIikgLyBfcHJlZnMuZ2V0SW50KFwicnNXXCIpKSAqIDEwMCxcbiAgICAgIHNjcm9sbEhvcml6VmFsID0gKF9hZGRpdGlvbmFsUGFyYW1zLnNjcm9sbEhvcml6b250YWwgPiAwKSA/XG4gICAgICAgICAgX2FkZGl0aW9uYWxQYXJhbXMuc2Nyb2xsSG9yaXpvbnRhbCA6IDAsXG4gICAgICBzY3JvbGxWZXJ0VmFsID0gKF9hZGRpdGlvbmFsUGFyYW1zLnNjcm9sbFZlcnRpY2FsID4gMCkgP1xuICAgICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zLnNjcm9sbFZlcnRpY2FsIDogMCxcbiAgICAgIHpvb20gPSBwYXJzZUZsb2F0KF9hZGRpdGlvbmFsUGFyYW1zLnpvb20pLFxuICAgICAgYmxvY2tlciwgem9vbVN0eWxlLCBtYXJnaW5TdHlsZTtcblxuICAgIGlmIChjb250YWluZXIgJiYgZnJhbWUpIHtcbiAgICAgIGJsb2NrZXIgPSBjb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJsb2NrZXJcIilbMF07XG5cbiAgICAgIC8vIEhpZGluZyBpZnJhbWUgY29udGFpbmVyLCB2aXNpYmxlIHdoZW4gdGhlIGlmcmFtZSBzdWNjZXNzZnVsbHkgbG9hZHNcbiAgICAgIGNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcblxuICAgICAgLy8gc2V0IHRoZSBwYWRkaW5nLWJvdHRvbSB3aXRoIHRoZSBhc3BlY3QgcmF0aW8gJSAocmVzcG9uc2l2ZSlcbiAgICAgIGlmIChzY3JvbGxWZXJ0VmFsICE9PSAwKSB7XG4gICAgICAgIC8vIHJlY2FsY3VsYXRlIGFzcGVjdCByYXRpb1xuICAgICAgICBhc3BlY3RSYXRpbyArPSAoc2Nyb2xsVmVydFZhbCAvIF9wcmVmcy5nZXRJbnQoXCJyc1dcIikpICogMTAwO1xuICAgICAgfVxuICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwicGFkZGluZy1ib3R0b206XCIgKyBhc3BlY3RSYXRpbyArIFwiJVwiKTtcblxuICAgICAgLy8gQ29uZmlndXJlIGludGVyYWN0aXZpdHkgb2YgaWZyYW1lXG4gICAgICBibG9ja2VyLnN0eWxlLmRpc3BsYXkgPSAoX2FkZGl0aW9uYWxQYXJhbXMuaW50ZXJhY3RpdmUpID8gXCJub25lXCIgOiBcImJsb2NrXCI7XG4gICAgICBmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzY3JvbGxpbmdcIixcbiAgICAgICAgKF9hZGRpdGlvbmFsUGFyYW1zLnNjcm9sbGJhcnMpID8gXCJ5ZXNcIiA6IFwibm9cIik7XG5cbiAgICAgIC8vIENvbmZpZ3VyZSB0aGUgem9vbSAoc2NhbGUpIHN0eWxpbmdcbiAgICAgIHpvb21TdHlsZSA9IFwiLW1zLXpvb206XCIgKyB6b29tICsgXCI7XCIgK1xuICAgICAgICBcIi1tb3otdHJhbnNmb3JtOiBzY2FsZShcIiArIHpvb20gKyBcIik7XCIgK1xuICAgICAgICBcIi1tb3otdHJhbnNmb3JtLW9yaWdpbjogMCAwO1wiICtcbiAgICAgICAgXCItby10cmFuc2Zvcm06IHNjYWxlKFwiICsgem9vbSArIFwiKTtcIiArXG4gICAgICAgIFwiLW8tdHJhbnNmb3JtLW9yaWdpbjogMCAwO1wiICtcbiAgICAgICAgXCItd2Via2l0LXRyYW5zZm9ybTogc2NhbGUoXCIgKyB6b29tICsgXCIpO1wiICtcbiAgICAgICAgXCItd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46IDAgMDtcIjtcblxuICAgICAgem9vbVN0eWxlICs9IFwid2lkdGg6IFwiICsgKCgxIC8gem9vbSkgKiAxMDApICsgXCIlO1wiICtcbiAgICAgIFwiaGVpZ2h0OiBcIiArICgoMSAvIHpvb20pICogMTAwKSArIFwiJTtcIjtcblxuICAgICAgLy8gQXBwbHkgdGhlIHpvb20gKHNjYWxlKSBvbiB0aGUgaWZyYW1lXG4gICAgICBmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCB6b29tU3R5bGUpO1xuXG4gICAgICBpZiAoc2Nyb2xsSG9yaXpWYWwgIT09IDAgfHwgc2Nyb2xsVmVydFZhbCAhPT0gMCkge1xuICAgICAgICAvLyBDb25maWd1cmUgdGhlIG1hcmdpbiBzdHlsaW5nXG4gICAgICAgIG1hcmdpblN0eWxlID0gXCJtYXJnaW46IFwiICsgXCItXCIgKyBzY3JvbGxWZXJ0VmFsICsgXCJweCAwIDAgLVwiICtcbiAgICAgICAgICBzY3JvbGxIb3JpelZhbCArIFwicHg7XCI7XG5cbiAgICAgICAgLyogQXBwbHkgdGhlIG1hcmdpbiBzdHlsaW5nIG9uIHRoZSBpZnJhbWUgd2hpbGUgbWFpbnRhaW5pbmdcbiAgICAgICAgIHRoZSB6b29tIHN0eWxpbmcgKi9cbiAgICAgICAgZnJhbWUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgem9vbVN0eWxlICsgbWFyZ2luU3R5bGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIF9sb2FkRnJhbWUoKSB7XG4gICAgdmFyIGZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3ZWJwYWdlLWZyYW1lXCIpLFxuICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3ZWJwYWdlLWNvbnRhaW5lclwiKSxcbiAgICAgIGhhc1BhcmFtcyA9IC9bPyMmXS8udGVzdChfdXJsKSxcbiAgICAgIHJhbmRvbU51bSA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogMTAwKSxcbiAgICAgIHJlZnJlc2hVUkwgPSBoYXNQYXJhbXMgP1xuICAgICAgICAgIF91cmwgKyBcIiZkdW1teVZhcj1cIiArIHJhbmRvbU51bSA6XG4gICAgICAgICAgX3VybCArIFwiP2R1bW15VmFyPVwiICsgcmFuZG9tTnVtO1xuXG4gICAgaWYgKGNvbnRhaW5lciAmJiBmcmFtZSkge1xuICAgICAgZnJhbWUub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmcmFtZS5vbmxvYWQgPSBudWxsO1xuXG4gICAgICAgIC8vIFNob3cgdGhlIGlmcmFtZSBjb250YWluZXJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcblxuICAgICAgICAvLyBSdW4gc2V0SW50ZXJ2YWwgdG8gcmVsb2FkIHBhZ2UgYmFzZWQgb24gdGhlIGRhdGEgcmVmcmVzaCB2YWx1ZVxuICAgICAgICBpZiAoX2FkZGl0aW9uYWxQYXJhbXMucmVmcmVzaCA+IDAgJiYgX2ludGVydmFsSWQgPT09IG51bGwpIHtcbiAgICAgICAgICBfaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9sb2FkRnJhbWUoKTtcbiAgICAgICAgICB9LCBfYWRkaXRpb25hbFBhcmFtcy5yZWZyZXNoKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgZnJhbWUuc2V0QXR0cmlidXRlKFwic3JjXCIsIHJlZnJlc2hVUkwpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIF91bmxvYWRGcmFtZSgpIHtcbiAgICB2YXIgZnJhbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIndlYnBhZ2UtZnJhbWVcIik7XG5cbiAgICBpZiAoX2FkZGl0aW9uYWxQYXJhbXMucmVmcmVzaCA+IDApIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwoX2ludGVydmFsSWQpO1xuICAgIH1cblxuICAgIGlmIChmcmFtZSkge1xuICAgICAgZnJhbWUuc3JjID0gXCJhYm91dDpibGFua1wiO1xuICAgIH1cblxuICB9XG5cbiAgZnVuY3Rpb24gX3JlYWR5KCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X3JlYWR5XCIsIG51bGwsIF9wcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSxcbiAgICAgIHRydWUsIHRydWUsIHRydWUsIHRydWUsIGZhbHNlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9iYWNrZ3JvdW5kUmVhZHkoKSB7XG4gICAgLy8gQ29uZmlndXJlIHRoZSB2YWx1ZSBmb3IgX3VybFxuICAgIF91cmwgPSBfYWRkaXRpb25hbFBhcmFtcy51cmw7XG5cbiAgICAvLyBBZGQgaHR0cDovLyBpZiBubyBwcm90b2NvbCBwYXJhbWV0ZXIgZXhpc3RzXG4gICAgaWYgKF91cmwuaW5kZXhPZihcIjovL1wiKSA9PT0gLTEpIHtcbiAgICAgIF91cmwgPSBcImh0dHA6Ly9cIiArIF91cmw7XG4gICAgfVxuXG4gICAgX2NvbmZpZ3VyZVBhZ2UoKTtcbiAgICBfcmVhZHkoKTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBfdW5sb2FkRnJhbWUoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgX2xvYWRGcmFtZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBfdW5sb2FkRnJhbWUoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldEFkZGl0aW9uYWxQYXJhbXMocGFyYW1zKSB7XG4gICAgX3ByZWZzID0gbmV3IGdhZGdldHMuUHJlZnMoKTtcbiAgICBfYWRkaXRpb25hbFBhcmFtcyA9IHBhcmFtcztcblxuICAgIC8vIGNyZWF0ZSBhbmQgaW5pdGlhbGl6ZSB0aGUgQmFja2dyb3VuZCBpbnN0YW5jZVxuICAgIF9iYWNrZ3JvdW5kID0gbmV3IFJpc2VWaXNpb24uQ29tbW9uLkJhY2tncm91bmQoX2FkZGl0aW9uYWxQYXJhbXMpO1xuICAgIF9iYWNrZ3JvdW5kLmluaXQoX2JhY2tncm91bmRSZWFkeSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHNldEFkZGl0aW9uYWxQYXJhbXM6IHNldEFkZGl0aW9uYWxQYXJhbXMsXG4gICAgcGF1c2U6IHBhdXNlLFxuICAgIHBsYXk6IHBsYXksXG4gICAgc3RvcDogc3RvcFxuICB9O1xuXG59KShkb2N1bWVudCwgZ2FkZ2V0cyk7XG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uQ29tbW9uID0gUmlzZVZpc2lvbi5Db21tb24gfHwge307XG5cblJpc2VWaXNpb24uQ29tbW9uLkJhY2tncm91bmQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2NhbGxiYWNrID0gbnVsbCxcbiAgICBfcmVhZHkgPSBmYWxzZSxcbiAgICBfYmFja2dyb3VuZCA9IG51bGwsXG4gICAgX3N0b3JhZ2UgPSBudWxsLFxuICAgIF9yZWZyZXNoRHVyYXRpb24gPSA5MDAwMDAsIC8vIDE1IG1pbnV0ZXNcbiAgICBfaXNTdG9yYWdlRmlsZSA9IGZhbHNlLFxuICAgIF9zZXBhcmF0b3IgPSBcIlwiO1xuXG4gIC8qXG4gICAqIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX3JlZnJlc2hUaW1lcigpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uIGJhY2tncm91bmRSZWZyZXNoKCkge1xuICAgICAgX2JhY2tncm91bmQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gXCJ1cmwoXCIgKyBkYXRhLmJhY2tncm91bmQuaW1hZ2UudXJsICsgX3NlcGFyYXRvciArIFwiY2I9XCIgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKSArIFwiKVwiO1xuICAgICAgX3JlZnJlc2hUaW1lcigpO1xuICAgIH0sIF9yZWZyZXNoRHVyYXRpb24pO1xuICB9XG5cbiAgZnVuY3Rpb24gX2JhY2tncm91bmRSZWFkeSgpIHtcbiAgICBfcmVhZHkgPSB0cnVlO1xuXG4gICAgaWYgKGRhdGEuYmFja2dyb3VuZC51c2VJbWFnZSAmJiAhX2lzU3RvcmFnZUZpbGUpIHtcbiAgICAgIC8vIHN0YXJ0IHRoZSByZWZyZXNoIHBvbGwgZm9yIG5vbi1zdG9yYWdlIGJhY2tncm91bmQgaW1hZ2VcbiAgICAgIF9yZWZyZXNoVGltZXIoKTtcbiAgICB9XG5cbiAgICBpZiAoX2NhbGxiYWNrICYmIHR5cGVvZiBfY2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgX2NhbGxiYWNrKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gX2NvbmZpZ3VyZSgpIHtcbiAgICB2YXIgc3RyO1xuXG4gICAgX2JhY2tncm91bmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhY2tncm91bmRcIik7XG4gICAgX3N0b3JhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhY2tncm91bmRTdG9yYWdlXCIpO1xuXG4gICAgLy8gc2V0IHRoZSBkb2N1bWVudCBiYWNrZ3JvdW5kXG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5iYWNrZ3JvdW5kID0gZGF0YS5iYWNrZ3JvdW5kLmNvbG9yO1xuXG4gICAgaWYgKF9iYWNrZ3JvdW5kKSB7XG4gICAgICBpZiAoZGF0YS5iYWNrZ3JvdW5kLnVzZUltYWdlKSB7XG4gICAgICAgIF9iYWNrZ3JvdW5kLmNsYXNzTmFtZSA9IGRhdGEuYmFja2dyb3VuZC5pbWFnZS5wb3NpdGlvbjtcbiAgICAgICAgX2JhY2tncm91bmQuY2xhc3NOYW1lID0gZGF0YS5iYWNrZ3JvdW5kLmltYWdlLnNjYWxlID8gX2JhY2tncm91bmQuY2xhc3NOYW1lICsgXCIgc2NhbGUtdG8tZml0XCJcbiAgICAgICAgICA6IF9iYWNrZ3JvdW5kLmNsYXNzTmFtZTtcblxuICAgICAgICBfaXNTdG9yYWdlRmlsZSA9IChPYmplY3Qua2V5cyhkYXRhLmJhY2tncm91bmRTdG9yYWdlKS5sZW5ndGggIT09IDApO1xuXG4gICAgICAgIGlmICghX2lzU3RvcmFnZUZpbGUpIHtcbiAgICAgICAgICBzdHIgPSBkYXRhLmJhY2tncm91bmQuaW1hZ2UudXJsLnNwbGl0KFwiP1wiKTtcblxuICAgICAgICAgIC8vIHN0b3JlIHRoaXMgZm9yIHRoZSByZWZyZXNoIHRpbWVyXG4gICAgICAgICAgX3NlcGFyYXRvciA9IChzdHIubGVuZ3RoID09PSAxKSA/IFwiP1wiIDogXCImXCI7XG5cbiAgICAgICAgICBfYmFja2dyb3VuZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybChcIiArIGRhdGEuYmFja2dyb3VuZC5pbWFnZS51cmwgKyBcIilcIjtcbiAgICAgICAgICBfYmFja2dyb3VuZFJlYWR5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKF9zdG9yYWdlKSB7XG4gICAgICAgICAgICAvLyBSaXNlIFN0b3JhZ2VcbiAgICAgICAgICAgIF9zdG9yYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2UtcmVzcG9uc2VcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgaWYgKGUuZGV0YWlsICYmIGUuZGV0YWlsLmZpbGVzICYmIGUuZGV0YWlsLmZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBfYmFja2dyb3VuZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybChcIiArIGUuZGV0YWlsLmZpbGVzWzBdLnVybCArIFwiKVwiO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKCFfcmVhZHkpIHtcbiAgICAgICAgICAgICAgICBfYmFja2dyb3VuZFJlYWR5KCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBfc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmb2xkZXJcIiwgZGF0YS5iYWNrZ3JvdW5kU3RvcmFnZS5mb2xkZXIpO1xuICAgICAgICAgICAgX3N0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZmlsZU5hbWVcIiwgZGF0YS5iYWNrZ3JvdW5kU3RvcmFnZS5maWxlTmFtZSk7XG4gICAgICAgICAgICBfc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJjb21wYW55SWRcIiwgZGF0YS5iYWNrZ3JvdW5kU3RvcmFnZS5jb21wYW55SWQpO1xuICAgICAgICAgICAgX3N0b3JhZ2UuZ28oKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJNaXNzaW5nIGVsZW1lbnQgd2l0aCBpZCB2YWx1ZSBvZiAnYmFja2dyb3VuZFN0b3JhZ2UnXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2JhY2tncm91bmRSZWFkeSgpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcIk1pc3NpbmcgZWxlbWVudCB3aXRoIGlkIHZhbHVlIG9mICdiYWNrZ3JvdW5kJ1wiKTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGluaXQoY2IpIHtcbiAgICBpZiAoIV9yZWFkeSkge1xuICAgICAgaWYgKGNiKSB7XG4gICAgICAgIF9jYWxsYmFjayA9IGNiO1xuICAgICAgfVxuXG4gICAgICBfY29uZmlndXJlKCk7XG5cbiAgICB9IGVsc2UgaWYgKGNiICYmIHR5cGVvZiBjYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBjYigpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJpbml0XCI6IGluaXRcbiAgfTtcbn07XG5cbi8qIGdsb2JhbCBSaXNlVmlzaW9uLCBnYWRnZXRzICovXG5cbihmdW5jdGlvbiAod2luZG93LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBwcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCksXG4gICAgaWQgPSBwcmVmcy5nZXRTdHJpbmcoXCJpZFwiKTtcblxuICAvLyBEaXNhYmxlIGNvbnRleHQgbWVudSAocmlnaHQgY2xpY2sgbWVudSlcbiAgd2luZG93Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgUmlzZVZpc2lvbi5XZWJQYWdlLnBsYXkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIFJpc2VWaXNpb24uV2ViUGFnZS5wYXVzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBSaXNlVmlzaW9uLldlYlBhZ2Uuc3RvcCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gYWRkaXRpb25hbFBhcmFtcyhuYW1lcywgdmFsdWVzKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkobmFtZXMpICYmIG5hbWVzLmxlbmd0aCA+IDAgJiYgbmFtZXNbMF0gPT09IFwiYWRkaXRpb25hbFBhcmFtc1wiKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZXMpICYmIHZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIFJpc2VWaXNpb24uV2ViUGFnZS5zZXRBZGRpdGlvbmFsUGFyYW1zKEpTT04ucGFyc2UodmFsdWVzWzBdKSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2x5bWVyLXJlYWR5XCIsIGZ1bmN0aW9uKCkge1xuICAgIGlmIChpZCAmJiBpZCAhPT0gXCJcIikge1xuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9wbGF5X1wiICsgaWQsIHBsYXkpO1xuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9wYXVzZV9cIiArIGlkLCBwYXVzZSk7XG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3N0b3BfXCIgKyBpZCwgc3RvcCk7XG5cbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNwYXJhbV9zZXRfXCIgKyBpZCwgYWRkaXRpb25hbFBhcmFtcyk7XG4gICAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNwYXJhbV9nZXRcIiwgbnVsbCwgaWQsIFtcImFkZGl0aW9uYWxQYXJhbXNcIl0pO1xuICAgIH1cbiAgfSk7XG5cbn0pKHdpbmRvdywgZ2FkZ2V0cyk7XG5cblxuXG4vKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovXG52YXIgX2dhcSA9IF9nYXEgfHwgW107XG5cbl9nYXEucHVzaChbJ19zZXRBY2NvdW50JywgJ1VBLTU3MDkyMTU5LTYnXSk7XG5fZ2FxLnB1c2goWydfdHJhY2tQYWdldmlldyddKTtcblxuKGZ1bmN0aW9uKCkge1xuICB2YXIgZ2EgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsgZ2EudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnOyBnYS5hc3luYyA9IHRydWU7XG4gIGdhLnNyYyA9ICgnaHR0cHM6JyA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCA/ICdodHRwczovL3NzbCcgOiAnaHR0cDovL3d3dycpICsgJy5nb29nbGUtYW5hbHl0aWNzLmNvbS9nYS5qcyc7XG4gIHZhciBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdOyBzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGdhLCBzKTtcbn0pKCk7XG4vKiBqc2hpbnQgaWdub3JlOmVuZCAqL1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9