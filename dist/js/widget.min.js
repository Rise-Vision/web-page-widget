var WIDGET_COMMON_CONFIG={AUTH_PATH_URL:"v1/widget/auth",LOGGER_CLIENT_ID:"1088527147109-6q1o2vtihn34292pjt4ckhmhck0rk0o7.apps.googleusercontent.com",LOGGER_CLIENT_SECRET:"nlZyrcPLg6oEwO9f9Wfn29Wh",LOGGER_REFRESH_TOKEN:"1/xzt4kwzE1H7W9VnKB8cAaCx6zb4Es4nKEoqaYHdTD15IgOrJDtdun6zK6XiATCKT",STORAGE_ENV:"prod",STORE_URL:"https://store-dot-rvaserver2.appspot.com/"},RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.LoggerUtils=function(){"use strict";function e(e,t){var i=null;e.event?(i=e,i.file_url&&(i.file_format=n(i.file_url)),i.company_id=a,i.display_id=r,t(i)):t(i)}function t(){var e=new Date,t=e.getUTCFullYear(),n=e.getUTCMonth()+1,i=e.getUTCDate();return 10>n&&(n="0"+n),10>i&&(i="0"+i),t+n+i}function n(e){var t,n=/[?#&]/;return e&&"string"==typeof e?(t=e.substr(e.lastIndexOf(".")+1),n.test(t)&&(t=t.substr(0,-1!==t.indexOf("?")?t.indexOf("?"):t.length),t=t.substr(0,-1!==t.indexOf("#")?t.indexOf("#"):t.length),t=t.substr(0,-1!==t.indexOf("&")?t.indexOf("&"):t.length)),t.toLowerCase()):null}function i(e){var n={kind:"bigquery#tableDataInsertAllRequest",skipInvalidRows:!1,ignoreUnknownValues:!1,templateSuffix:t(),rows:[{insertId:""}]},i=JSON.parse(JSON.stringify(n));return i.rows[0].insertId=Math.random().toString(36).substr(2).toUpperCase(),i.rows[0].json=JSON.parse(JSON.stringify(e)),i.rows[0].json.ts=(new Date).toISOString(),i}function o(t,n){e(n,function(e){null!==e&&RiseVision.Common.Logger.log(t,e)})}function s(e,t){a=e,r=t}var r="",a="";return{getInsertData:i,getFileFormat:n,logEvent:o,setIds:s}}(),RiseVision.Common.Logger=function(e){"use strict";function t(e){var t=new XMLHttpRequest;return new Date-c<358e4?e({}):(t.open("POST",o,!0),t.onloadend=function(){var n=JSON.parse(t.response);e({token:n.access_token,refreshedAt:new Date})},t.send(),void 0)}function n(e){return r&&l===e}function i(i,o){function g(t){var n,r,a=new XMLHttpRequest;r=s.replace("TABLE_ID",i),c=t.refreshedAt||c,u=t.token||u,n=e.getInsertData(o),a.open("POST",r,!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization","Bearer "+u),o.cb&&"function"==typeof o.cb&&(a.onloadend=function(){o.cb(a.response)}),a.send(JSON.stringify(n))}if(!(!i||!o||o.hasOwnProperty("event")&&!o.event||o.hasOwnProperty("event")&&n(o.event)))return r=!0,l=o.event,setTimeout(function(){r=!1},a),t(g)}var o="https://www.googleapis.com/oauth2/v3/token?client_id="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_ID+"&client_secret="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_SECRET+"&refresh_token="+WIDGET_COMMON_CONFIG.LOGGER_REFRESH_TOKEN+"&grant_type=refresh_token",s="https://www.googleapis.com/bigquery/v2/projects/client-side-events/datasets/Widget_Events/tables/TABLE_ID/insertAll",r=!1,a=1e3,l="",c=0,u="";return{log:i}}(RiseVision.Common.LoggerUtils),"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json");var config={STORAGE_ENV:"prod"},RiseVision=RiseVision||{};RiseVision.WebPage={},RiseVision.WebPage=function(e,t){"use strict";function n(){t.rpc.call("","rsevent_ready",null,h.getString("id"),!0,!0,!0,!0,!1)}function i(e){function t(t){var n=!0,i=t.target.getResponseHeader("X-Frame-Options");i&&"SAMEORIGIN"===i.toUpperCase()&&(f({event:"error",event_details:"X-Frame-Options header",error_details:"SAMEORIGIN",url:E}),O.show("The owner of the Web Page at the URL provided does not allow the Page to be embedded within an iFrame. If possible, please contact the Web Page owner to discuss X-Frame-Options."),n=!1),e&&"function"==typeof e&&e(n)}var n="https://proxy.risevision.com/"+E,i=new XMLHttpRequest;i.addEventListener("load",t),i.open("GET",n),i.send()}function o(){var t=e.getElementById("webpage-frame"),n=e.querySelector(".blocker");n.style.display=_.interactivity.interactive?"none":"block",t.setAttribute("scrolling",_.interactivity.interactive&&_.interactivity.scrollbars?"yes":"no")}function s(){var t=e.getElementById("container"),n=e.getElementById("webpage-frame"),i=h.getInt("rsH")/h.getInt("rsW")*100;t&&n&&(t.style.visibility="hidden",o(),a(n),r(n),0!==R&&(i+=R/h.getInt("rsW")*100),t.setAttribute("style","padding-bottom:"+i+"%"))}function r(e){var t,n=parseFloat(_.zoom);t="-ms-zoom:"+n+";-moz-transform: scale("+n+");-moz-transform-origin: 0 0;-o-transform: scale("+n+");-o-transform-origin: 0 0;-webkit-transform: scale("+n+");-webkit-transform-origin: 0 0;transform: scale("+n+");transform-origin: 0 0;",t+="width: "+1/n*100+"%;height: "+1/n*100+"%;";var i=e.getAttribute("style");i&&(t=i+t),e.setAttribute("style",t)}function a(e){var t="",n=0;if(_.region&&_.region.showRegion&&"region"===_.region.showRegion&&(_.region.horizontal>0&&(n=_.region.horizontal),_.region.vertical>0&&(R=_.region.vertical),0!==n||0!==R)){t="margin: -"+R+"px 0 0 -"+n+"px;";var i=e.getAttribute("style");i&&(t=i+t),e.setAttribute("style",t)}}function l(){b=setInterval(function(){c()},_.refresh)}function c(){var t=e.getElementById("webpage-frame"),n=e.getElementById("container");n&&t&&(t.onload=function(){t.onload=null,n.style.visibility="visible",_.refresh>0&&null===b&&l()},t.setAttribute("src",E))}function u(){var t=e.getElementById("webpage-frame");_.refresh>0&&clearInterval(b),t&&(t.src="about:blank")}function g(){O=new RiseVision.Common.Message(e.getElementById("container"),e.getElementById("messageContainer")),E=_.url,-1===E.indexOf("://")&&(E="http://"+E),i(function(e){e&&s(),n()})}function d(){return"webpage_events"}function f(e){RiseVision.Common.LoggerUtils.logEvent(d(),e)}function p(){u()}function m(){c()}function v(){p()}function y(e){_=JSON.parse(JSON.stringify(e)),g()}var h=new t.Prefs,_=null,E="",R=0,b=null,O=null;return{getTableName:d,logEvent:f,setAdditionalParams:y,pause:p,play:m,stop:v}}(document,gadgets);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Message=function(e,t){"use strict";function n(){try{t.style.height=e.style.height}catch(n){console.warn("Can't initialize Message - ",n.message)}}function i(){if(s){for(;t.firstChild;)t.removeChild(t.firstChild);t.style.display="none",e.style.visibility="visible",s=!1}}function o(n){var i,o=document.createDocumentFragment();s?(i=t.querySelector(".message"),i.innerHTML=n):(e.style.visibility="hidden",t.style.display="block",i=document.createElement("p"),i.innerHTML=n,i.setAttribute("class","message"),o.appendChild(i),t.appendChild(o),s=!0)}var s=!1;return n(),{hide:i,show:o}},function(e,t,n){"use strict";function i(e,t){var n,i="",o="";Array.isArray(e)&&e.length>0&&Array.isArray(t)&&t.length>0&&("companyId"===e[0]&&(i=t[0]),"displayId"===e[1]&&(o=t[1]?t[1]:"preview"),RiseVision.Common.LoggerUtils.setIds(i,o),"additionalParams"===e[2]&&(n=JSON.parse(t[2]),RiseVision.WebPage.setAdditionalParams(n)))}function o(){RiseVision.WebPage.play()}function s(){RiseVision.WebPage.pause()}function r(){RiseVision.WebPage.stop()}var a=(new n.Prefs).getString("id");e.oncontextmenu=function(){return!1},t.body.onmousedown=function(){return!1},a&&""!==a&&(n.rpc.register("rscmd_play_"+a,o),n.rpc.register("rscmd_pause_"+a,s),n.rpc.register("rscmd_stop_"+a,r),n.rpc.register("rsparam_set_"+a,i),n.rpc.call("","rsparam_get",null,a,["companyId","displayId","additionalParams"]))}(window,document,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-6"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiV0lER0VUX0NPTU1PTl9DT05GSUciLCJBVVRIX1BBVEhfVVJMIiwiTE9HR0VSX0NMSUVOVF9JRCIsIkxPR0dFUl9DTElFTlRfU0VDUkVUIiwiTE9HR0VSX1JFRlJFU0hfVE9LRU4iLCJTVE9SQUdFX0VOViIsIlNUT1JFX1VSTCIsIlJpc2VWaXNpb24iLCJDb21tb24iLCJMb2dnZXJVdGlscyIsImdldEV2ZW50UGFyYW1zIiwicGFyYW1zIiwiY2IiLCJqc29uIiwiZXZlbnQiLCJmaWxlX3VybCIsImZpbGVfZm9ybWF0IiwiZ2V0RmlsZUZvcm1hdCIsImNvbXBhbnlfaWQiLCJjb21wYW55SWQiLCJkaXNwbGF5X2lkIiwiZGlzcGxheUlkIiwiZ2V0U3VmZml4IiwiZGF0ZSIsIkRhdGUiLCJ5ZWFyIiwiZ2V0VVRDRnVsbFllYXIiLCJtb250aCIsImdldFVUQ01vbnRoIiwiZGF5IiwiZ2V0VVRDRGF0ZSIsInVybCIsInN0ciIsImhhc1BhcmFtcyIsInN1YnN0ciIsImxhc3RJbmRleE9mIiwidGVzdCIsImluZGV4T2YiLCJsZW5ndGgiLCJ0b0xvd2VyQ2FzZSIsImdldEluc2VydERhdGEiLCJCQVNFX0lOU0VSVF9TQ0hFTUEiLCJraW5kIiwic2tpcEludmFsaWRSb3dzIiwiaWdub3JlVW5rbm93blZhbHVlcyIsInRlbXBsYXRlU3VmZml4Iiwicm93cyIsImluc2VydElkIiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInRvVXBwZXJDYXNlIiwidHMiLCJ0b0lTT1N0cmluZyIsImxvZ0V2ZW50IiwidGFibGUiLCJMb2dnZXIiLCJsb2ciLCJzZXRJZHMiLCJjb21wYW55IiwiZGlzcGxheSIsInV0aWxzIiwicmVmcmVzaFRva2VuIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJyZWZyZXNoRGF0ZSIsIm9wZW4iLCJSRUZSRVNIX1VSTCIsIm9ubG9hZGVuZCIsInJlc3AiLCJyZXNwb25zZSIsInRva2VuIiwiYWNjZXNzX3Rva2VuIiwicmVmcmVzaGVkQXQiLCJzZW5kIiwiaXNUaHJvdHRsZWQiLCJ0aHJvdHRsZSIsImxhc3RFdmVudCIsInRhYmxlTmFtZSIsImluc2VydFdpdGhUb2tlbiIsInJlZnJlc2hEYXRhIiwiaW5zZXJ0RGF0YSIsInNlcnZpY2VVcmwiLCJyZXBsYWNlIiwic2V0UmVxdWVzdEhlYWRlciIsImhhc093blByb3BlcnR5Iiwic2V0VGltZW91dCIsInRocm90dGxlRGVsYXkiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uc3RhbnQiLCJjb25maWciLCJXZWJQYWdlIiwiZG9jdW1lbnQiLCJnYWRnZXRzIiwiX3JlYWR5IiwicnBjIiwiY2FsbCIsIl9wcmVmcyIsImdldFN0cmluZyIsIl92YWxpZGF0ZVVybCIsImhhbmRsZVByb3h5UmVzcG9uc2UiLCJlIiwic3VjY2VzcyIsImhlYWRlciIsInRhcmdldCIsImdldFJlc3BvbnNlSGVhZGVyIiwiZXZlbnRfZGV0YWlscyIsImVycm9yX2RldGFpbHMiLCJfdXJsIiwiX21lc3NhZ2UiLCJzaG93IiwicHJveHlVcmwiLCJyZXF1ZXN0IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9zZXRJbnRlcmFjdGl2aXR5IiwiZnJhbWUiLCJnZXRFbGVtZW50QnlJZCIsImJsb2NrZXIiLCJxdWVyeVNlbGVjdG9yIiwic3R5bGUiLCJfYWRkaXRpb25hbFBhcmFtcyIsImludGVyYWN0aXZpdHkiLCJzZXRBdHRyaWJ1dGUiLCJpbnRlcmFjdGl2ZSIsInNjcm9sbGJhcnMiLCJfY29uZmlndXJlUGFnZSIsImNvbnRhaW5lciIsImFzcGVjdFJhdGlvIiwiZ2V0SW50IiwidmlzaWJpbGl0eSIsIl9zZXRSZWdpb24iLCJfc2V0Wm9vbSIsIl92ZXJ0aWNhbCIsInpvb21TdHlsZSIsInpvb20iLCJwYXJzZUZsb2F0IiwiY3VycmVudFN0eWxlIiwiZ2V0QXR0cmlidXRlIiwibWFyZ2luU3R5bGUiLCJob3Jpem9udGFsIiwicmVnaW9uIiwic2hvd1JlZ2lvbiIsInZlcnRpY2FsIiwiX3N0YXJ0UmVmcmVzaEludGVydmFsIiwiX2ludGVydmFsSWQiLCJzZXRJbnRlcnZhbCIsIl9sb2FkRnJhbWUiLCJyZWZyZXNoIiwib25sb2FkIiwiX3VubG9hZEZyYW1lIiwiY2xlYXJJbnRlcnZhbCIsInNyYyIsIl9pbml0IiwiTWVzc2FnZSIsImdldFRhYmxlTmFtZSIsInBhdXNlIiwicGxheSIsInN0b3AiLCJzZXRBZGRpdGlvbmFsUGFyYW1zIiwiYWRkaXRpb25hbFBhcmFtcyIsIlByZWZzIiwibWFpbkNvbnRhaW5lciIsIm1lc3NhZ2VDb250YWluZXIiLCJoZWlnaHQiLCJjb25zb2xlIiwid2FybiIsIm1lc3NhZ2UiLCJoaWRlIiwiX2FjdGl2ZSIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsInAiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJpbm5lckhUTUwiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJ3aW5kb3ciLCJjb25maWd1cmUiLCJuYW1lcyIsInZhbHVlcyIsIkFycmF5IiwiaXNBcnJheSIsImlkIiwib25jb250ZXh0bWVudSIsImJvZHkiLCJvbm1vdXNlZG93biIsInJlZ2lzdGVyIiwiX2dhcSIsInB1c2giLCJnYSIsInR5cGUiLCJhc3luYyIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIl0sIm1hcHBpbmdzIjoiQUFDQSxHQUFJQSx1QkFDRkMsY0FBZSxpQkFDZkMsaUJBQWtCLDRFQUNsQkMscUJBQXNCLDJCQUN0QkMscUJBQXNCLHFFQUN0QkMsWUFBYSxPQUNiQyxVQUFXLDZDQUlUQyxXQUFhQSxjQUNqQkEsWUFBV0MsT0FBU0QsV0FBV0MsV0FFL0JELFdBQVdDLE9BQU9DLFlBQWMsV0FDOUIsWUFVQSxTQUFTQyxHQUFlQyxFQUFRQyxHQUM5QixHQUFJQyxHQUFPLElBR1BGLEdBQU9HLE9BQ1RELEVBQU9GLEVBRUhFLEVBQUtFLFdBQ1BGLEVBQUtHLFlBQWNDLEVBQWNKLEVBQUtFLFdBR3hDRixFQUFLSyxXQUFhQyxFQUNsQk4sRUFBS08sV0FBYUMsRUFFbEJULEVBQUdDLElBR0hELEVBQUdDLEdBS1AsUUFBU1MsS0FDUCxHQUFJQyxHQUFPLEdBQUlDLE1BQ2JDLEVBQU9GLEVBQUtHLGlCQUNaQyxFQUFRSixFQUFLSyxjQUFnQixFQUM3QkMsRUFBTU4sRUFBS08sWUFVYixPQVJZLElBQVJILElBQ0ZBLEVBQVEsSUFBTUEsR0FHTixHQUFORSxJQUNGQSxFQUFNLElBQU1BLEdBR1BKLEVBQU9FLEVBQVFFLEVBTXhCLFFBQVNaLEdBQWNjLEdBQ3JCLEdBQ0VDLEdBREVDLEVBQVksT0FHaEIsT0FBS0YsSUFBc0IsZ0JBQVJBLElBSW5CQyxFQUFNRCxFQUFJRyxPQUFPSCxFQUFJSSxZQUFZLEtBQU8sR0FHcENGLEVBQVVHLEtBQUtKLEtBQ2pCQSxFQUFNQSxFQUFJRSxPQUFPLEVBQXlCLEtBQXJCRixFQUFJSyxRQUFRLEtBQWVMLEVBQUlLLFFBQVEsS0FBT0wsRUFBSU0sUUFFdkVOLEVBQU1BLEVBQUlFLE9BQU8sRUFBeUIsS0FBckJGLEVBQUlLLFFBQVEsS0FBZUwsRUFBSUssUUFBUSxLQUFPTCxFQUFJTSxRQUV2RU4sRUFBTUEsRUFBSUUsT0FBTyxFQUF5QixLQUFyQkYsRUFBSUssUUFBUSxLQUFlTCxFQUFJSyxRQUFRLEtBQU9MLEVBQUlNLFNBR2xFTixFQUFJTyxlQWRGLEtBaUJYLFFBQVNDLEdBQWM3QixHQUNyQixHQUFJOEIsSUFDRkMsS0FBUSxxQ0FDUkMsaUJBQW1CLEVBQ25CQyxxQkFBdUIsRUFDdkJDLGVBQWtCdkIsSUFDbEJ3QixPQUNFQyxTQUFZLE1BR2hCQyxFQUFPQyxLQUFLQyxNQUFNRCxLQUFLRSxVQUFVVixHQU1qQyxPQUpBTyxHQUFLRixLQUFLLEdBQUdDLFNBQVdLLEtBQUtDLFNBQVNDLFNBQVMsSUFBSXBCLE9BQU8sR0FBR3FCLGNBQzdEUCxFQUFLRixLQUFLLEdBQUdqQyxLQUFPb0MsS0FBS0MsTUFBTUQsS0FBS0UsVUFBVXhDLElBQzlDcUMsRUFBS0YsS0FBSyxHQUFHakMsS0FBSzJDLElBQUssR0FBSWhDLE9BQU9pQyxjQUUzQlQsRUFHVCxRQUFTVSxHQUFTQyxFQUFPaEQsR0FDdkJELEVBQWVDLEVBQVEsU0FBU0UsR0FDakIsT0FBVEEsR0FDRk4sV0FBV0MsT0FBT29ELE9BQU9DLElBQUlGLEVBQU85QyxLQU0xQyxRQUFTaUQsR0FBT0MsRUFBU0MsR0FDdkI3QyxFQUFZNEMsRUFDWjFDLEVBQVkyQyxFQXRHYixHQUFJM0MsR0FBWSxHQUNmRixFQUFZLEVBd0dkLFFBQ0VxQixjQUFpQkEsRUFDakJ2QixjQUFpQkEsRUFDakJ5QyxTQUFZQSxFQUNaSSxPQUFVQSxNQUlkdkQsV0FBV0MsT0FBT29ELE9BQVMsU0FBVUssR0FDbkMsWUFpQkEsU0FBU0MsR0FBYXRELEdBQ3BCLEdBQUl1RCxHQUFNLEdBQUlDLGVBRWQsT0FBSSxJQUFJNUMsTUFBUzZDLEVBQWMsTUFDdEJ6RCxPQUdUdUQsRUFBSUcsS0FBSyxPQUFRQyxHQUFhLEdBQzlCSixFQUFJSyxVQUFZLFdBQ2QsR0FBSUMsR0FBT3hCLEtBQUtDLE1BQU1pQixFQUFJTyxTQUUxQjlELElBQUsrRCxNQUFPRixFQUFLRyxhQUFjQyxZQUFhLEdBQUlyRCxTQUdsRDJDLEVBQUlXLE9BUEpYLFFBVUYsUUFBU1ksR0FBWWpFLEdBQ25CLE1BQU9rRSxJQUFhQyxJQUFjbkUsRUFNcEMsUUFBUytDLEdBQUlxQixFQUFXdkUsR0FhdEIsUUFBU3dFLEdBQWdCQyxHQUN2QixHQUNFQyxHQUFZdEQsRUFEVm9DLEVBQU0sR0FBSUMsZUFHZHJDLEdBQU11RCxFQUFXQyxRQUFRLFdBQVlMLEdBQ3JDYixFQUFjZSxFQUFZUCxhQUFlUixFQUN6Q00sRUFBUVMsRUFBWVQsT0FBU0EsRUFDN0JVLEVBQWFwQixFQUFNekIsY0FBYzdCLEdBR2pDd0QsRUFBSUcsS0FBSyxPQUFRdkMsR0FBSyxHQUN0Qm9DLEVBQUlxQixpQkFBaUIsZUFBZ0Isb0JBQ3JDckIsRUFBSXFCLGlCQUFpQixnQkFBaUIsVUFBWWIsR0FFOUNoRSxFQUFPQyxJQUEyQixrQkFBZEQsR0FBT0MsS0FDN0J1RCxFQUFJSyxVQUFZLFdBQ2Q3RCxFQUFPQyxHQUFHdUQsRUFBSU8sWUFJbEJQLEVBQUlXLEtBQUs3QixLQUFLRSxVQUFVa0MsSUFoQzFCLE1BQUtILElBQWN2RSxHQUFXQSxFQUFPOEUsZUFBZSxXQUFhOUUsRUFBT0csT0FDckVILEVBQU84RSxlQUFlLFVBQVlWLEVBQVlwRSxFQUFPRyxRQWtDeEQsTUE5QkFrRSxJQUFXLEVBQ1hDLEVBQVl0RSxFQUFPRyxNQUVuQjRFLFdBQVcsV0FDVFYsR0FBVyxHQUNWVyxHQXlCSXpCLEVBQWFpQixHQTNFdEIsR0FBSVosR0FBYyx3REFBMER2RSxxQkFBcUJFLGlCQUM3RixrQkFBb0JGLHFCQUFxQkcscUJBQ3pDLGtCQUFvQkgscUJBQXFCSSxxQkFDekMsNEJBRUFrRixFQUFhLHNIQUNmTixHQUFXLEVBQ1hXLEVBQWdCLElBQ2hCVixFQUFZLEdBQ1paLEVBQWMsRUFDZE0sRUFBUSxFQW9FVixRQUNFZCxJQUFPQSxJQUVSdEQsV0FBV0MsT0FBT0MsYUFFRSxtQkFBWm1GLFVBQ1RBLFFBQVFDLE9BQU8sb0NBQ1pDLFNBQVMsaUJBQWtCLHdCQUMzQkEsU0FBUyxnQkFBaUIsUUFHL0IsSUFBSUMsU0FDRjFGLFlBQWEsUUFLWEUsV0FBYUEsY0FDakJBLFlBQVd5RixXQUVYekYsV0FBV3lGLFFBQVUsU0FBV0MsRUFBVUMsR0FFeEMsWUFjQSxTQUFTQyxLQUNQRCxFQUFRRSxJQUFJQyxLQUFLLEdBQUksZ0JBQWlCLEtBQU1DLEVBQU9DLFVBQVUsT0FDM0QsR0FBTSxHQUFNLEdBQU0sR0FBTSxHQUc1QixRQUFTQyxHQUFhNUYsR0FJcEIsUUFBUzZGLEdBQW9CQyxHQUMzQixHQUFJQyxJQUFVLEVBQ1pDLEVBQVNGLEVBQUVHLE9BQU9DLGtCQUFrQixrQkFFbENGLElBQW9DLGVBQXpCQSxFQUFPckQsZ0JBQ3BCRyxHQUNFNUMsTUFBUyxRQUNUaUcsY0FBaUIseUJBQ2pCQyxjQUFpQixhQUNqQmpGLElBQU9rRixJQUdUQyxFQUFTQyxLQUFLLHFMQUlkUixHQUFVLEdBR1IvRixHQUFxQixrQkFBUEEsSUFDaEJBLEVBQUcrRixHQXZCUCxHQUFJUyxHQUFXLGdDQUFrQ0gsRUFDL0NJLEVBQVUsR0FBSWpELGVBMEJoQmlELEdBQVFDLGlCQUFpQixPQUFRYixHQUNqQ1ksRUFBUS9DLEtBQUssTUFBTzhDLEdBQ3BCQyxFQUFRdkMsT0FHVixRQUFTeUMsS0FDUCxHQUFJQyxHQUFRdkIsRUFBU3dCLGVBQWUsaUJBQ2xDQyxFQUFVekIsRUFBUzBCLGNBQWMsV0FFbkNELEdBQVFFLE1BQU01RCxRQUFXNkQsRUFBa0JDLGNBQXlCLFlBQUksT0FBUyxRQUVqRk4sRUFBTU8sYUFBYSxZQUNoQkYsRUFBa0JDLGNBQWNFLGFBQWVILEVBQWtCQyxjQUFjRyxXQUFjLE1BQVEsTUFHMUcsUUFBU0MsS0FDUCxHQUFJQyxHQUFZbEMsRUFBU3dCLGVBQWUsYUFDdENELEVBQVF2QixFQUFTd0IsZUFBZSxpQkFDaENXLEVBQWdCOUIsRUFBTytCLE9BQU8sT0FBUy9CLEVBQU8rQixPQUFPLE9BQVUsR0FFN0RGLElBQWFYLElBRWZXLEVBQVVQLE1BQU1VLFdBQWEsU0FFN0JmLElBQ0FnQixFQUFXZixHQUNYZ0IsRUFBU2hCLEdBR1MsSUFBZGlCLElBQ0ZMLEdBQWdCSyxFQUFZbkMsRUFBTytCLE9BQU8sT0FBVSxLQUd0REYsRUFBVUosYUFBYSxRQUFTLGtCQUFvQkssRUFBYyxNQUl0RSxRQUFTSSxHQUFTaEIsR0FDakIsR0FDRWtCLEdBREVDLEVBQU9DLFdBQVdmLEVBQWtCYyxLQUl2Q0QsR0FBWSxZQUFjQyxFQUFPLDBCQUNKQSxFQUFPLG9EQUVUQSxFQUFPLHVEQUVGQSxFQUFPLG9EQUVmQSxFQUFPLDJCQUcvQkQsR0FBYSxVQUFjLEVBQUlDLEVBQVEsSUFBTyxhQUM3QixFQUFJQSxFQUFRLElBQU8sSUFFcEMsSUFBSUUsR0FBZXJCLEVBQU1zQixhQUFhLFFBQ2xDRCxLQUNGSCxFQUFZRyxFQUFlSCxHQUc3QmxCLEVBQU1PLGFBQWEsUUFBU1csR0FHOUIsUUFBU0gsR0FBV2YsR0FDbEIsR0FBSXVCLEdBQWMsR0FDaEJDLEVBQWEsQ0FFZixJQUFJbkIsRUFBa0JvQixRQUFVcEIsRUFBa0JvQixPQUFPQyxZQUNkLFdBQXhDckIsRUFBa0JvQixPQUFPQyxhQUN0QnJCLEVBQWtCb0IsT0FBT0QsV0FBYSxJQUN4Q0EsRUFBYW5CLEVBQWtCb0IsT0FBT0QsWUFHcENuQixFQUFrQm9CLE9BQU9FLFNBQVcsSUFDdENWLEVBQVlaLEVBQWtCb0IsT0FBT0UsVUFJbkIsSUFBZkgsR0FBb0MsSUFBZFAsR0FBa0IsQ0FDM0NNLEVBQWMsWUFBbUJOLEVBQVksV0FBYU8sRUFBYSxLQUV2RSxJQUFJSCxHQUFlckIsRUFBTXNCLGFBQWEsUUFDbENELEtBQ0ZFLEVBQWNGLEVBQWVFLEdBRy9CdkIsRUFBTU8sYUFBYSxRQUFTZ0IsSUFLbEMsUUFBU0ssS0FDUEMsRUFBY0MsWUFBWSxXQUV4QkMsS0FDQzFCLEVBQWtCMkIsU0FHdkIsUUFBU0QsS0FDUCxHQUFJL0IsR0FBUXZCLEVBQVN3QixlQUFlLGlCQUNsQ1UsRUFBWWxDLEVBQVN3QixlQUFlLFlBRWxDVSxJQUFhWCxJQUNmQSxFQUFNaUMsT0FBUyxXQUNiakMsRUFBTWlDLE9BQVMsS0FHZnRCLEVBQVVQLE1BQU1VLFdBQWEsVUFHekJULEVBQWtCMkIsUUFBVSxHQUFxQixPQUFoQkgsR0FDbkNELEtBSUo1QixFQUFNTyxhQUFhLE1BQU9kLElBSTlCLFFBQVN5QyxLQUNQLEdBQUlsQyxHQUFRdkIsRUFBU3dCLGVBQWUsZ0JBRWhDSSxHQUFrQjJCLFFBQVUsR0FDOUJHLGNBQWNOLEdBR1o3QixJQUNGQSxFQUFNb0MsSUFBTSxlQUtoQixRQUFTQyxLQUNQM0MsRUFBVyxHQUFJM0csWUFBV0MsT0FBT3NKLFFBQVE3RCxFQUFTd0IsZUFBZSxhQUMvRHhCLEVBQVN3QixlQUFlLHFCQUcxQlIsRUFBT1ksRUFBa0I5RixJQUdHLEtBQXhCa0YsRUFBSzVFLFFBQVEsU0FDZjRFLEVBQU8sVUFBWUEsR0FHckJULEVBQWEsU0FBU0csR0FDaEJBLEdBQ0Z1QixJQUdGL0IsTUFPSixRQUFTNEQsS0FDUCxNQUFPLGlCQUdULFFBQVNyRyxHQUFTL0MsR0FDaEJKLFdBQVdDLE9BQU9DLFlBQVlpRCxTQUFTcUcsSUFBZ0JwSixHQUd6RCxRQUFTcUosS0FDUE4sSUFHRixRQUFTTyxLQUNQVixJQUdGLFFBQVNXLEtBQ1BGLElBR0YsUUFBU0csR0FBb0JDLEdBQzNCdkMsRUFBb0I1RSxLQUFLQyxNQUFNRCxLQUFLRSxVQUFVaUgsSUFFOUNQLElBL05GLEdBQUl2RCxHQUFTLEdBQUlKLEdBQVFtRSxNQUN2QnhDLEVBQW9CLEtBQ3BCWixFQUFPLEdBQ1B3QixFQUFZLEVBQ1pZLEVBQWMsS0FFWm5DLEVBQVcsSUE0TmYsUUFDRTZDLGFBQWdCQSxFQUNoQnJHLFNBQVlBLEVBQ1p5RyxvQkFBdUJBLEVBQ3ZCSCxNQUFTQSxFQUNUQyxLQUFRQSxFQUNSQyxLQUFRQSxJQUdUakUsU0FBVUMsUUFFYixJQUFJM0YsWUFBYUEsY0FDakJBLFlBQVdDLE9BQVNELFdBQVdDLFdBRS9CRCxXQUFXQyxPQUFPc0osUUFBVSxTQUFVUSxFQUFlQyxHQUNuRCxZQUlBLFNBQVNWLEtBQ1AsSUFDRVUsRUFBaUIzQyxNQUFNNEMsT0FBU0YsRUFBYzFDLE1BQU00QyxPQUNwRCxNQUFPOUQsR0FDUCtELFFBQVFDLEtBQUssOEJBQStCaEUsRUFBRWlFLFVBT2xELFFBQVNDLEtBQ1AsR0FBSUMsRUFBUyxDQUVYLEtBQU9OLEVBQWlCTyxZQUN0QlAsRUFBaUJRLFlBQVlSLEVBQWlCTyxXQUloRFAsR0FBaUIzQyxNQUFNNUQsUUFBVSxPQUdqQ3NHLEVBQWMxQyxNQUFNVSxXQUFhLFVBRWpDdUMsR0FBVSxHQUlkLFFBQVMxRCxHQUFLd0QsR0FDWixHQUNFSyxHQURFQyxFQUFXaEYsU0FBU2lGLHdCQUduQkwsSUFpQkhHLEVBQUlULEVBQWlCNUMsY0FBYyxZQUNuQ3FELEVBQUVHLFVBQVlSLElBaEJkTCxFQUFjMUMsTUFBTVUsV0FBYSxTQUVqQ2lDLEVBQWlCM0MsTUFBTTVELFFBQVUsUUFHakNnSCxFQUFJL0UsU0FBU21GLGNBQWMsS0FDM0JKLEVBQUVHLFVBQVlSLEVBQ2RLLEVBQUVqRCxhQUFhLFFBQVMsV0FFeEJrRCxFQUFTSSxZQUFZTCxHQUNyQlQsRUFBaUJjLFlBQVlKLEdBRTdCSixHQUFVLEdBaERkLEdBQUlBLElBQVUsQ0EwRGQsT0FGQWhCLE1BR0VlLEtBQVFBLEVBQ1J6RCxLQUFRQSxJQU1aLFNBQVdtRSxFQUFRckYsRUFBVUMsR0FDM0IsWUFhQSxTQUFTcUYsR0FBVUMsRUFBT0MsR0FDeEIsR0FBSXJCLEdBQ0ZqSixFQUFZLEdBQ1pFLEVBQVksRUFFVnFLLE9BQU1DLFFBQVFILElBQVVBLEVBQU1sSixPQUFTLEdBQUtvSixNQUFNQyxRQUFRRixJQUFXQSxFQUFPbkosT0FBUyxJQUV0RSxjQUFia0osRUFBTSxLQUNSckssRUFBWXNLLEVBQU8sSUFJSixjQUFiRCxFQUFNLEtBRU5uSyxFQURFb0ssRUFBTyxHQUNHQSxFQUFPLEdBR1AsV0FLaEJsTCxXQUFXQyxPQUFPQyxZQUFZcUQsT0FBTzNDLEVBQVdFLEdBRy9CLHFCQUFibUssRUFBTSxLQUNScEIsRUFBbUJuSCxLQUFLQyxNQUFNdUksRUFBTyxJQUVyQ2xMLFdBQVd5RixRQUFRbUUsb0JBQW9CQyxLQUs3QyxRQUFTSCxLQUNQMUosV0FBV3lGLFFBQVFpRSxPQUdyQixRQUFTRCxLQUNQekosV0FBV3lGLFFBQVFnRSxRQUdyQixRQUFTRSxLQUNQM0osV0FBV3lGLFFBQVFrRSxPQXJEckIsR0FBSTBCLElBQUssR0FBSTFGLEdBQVFtRSxPQUFROUQsVUFBVSxLQUd2QytFLEdBQU9PLGNBQWdCLFdBQ3JCLE9BQU8sR0FHVDVGLEVBQVM2RixLQUFLQyxZQUFjLFdBQzFCLE9BQU8sR0FnRExILEdBQWEsS0FBUEEsSUFDUjFGLEVBQVFFLElBQUk0RixTQUFTLGNBQWdCSixFQUFJM0IsR0FDekMvRCxFQUFRRSxJQUFJNEYsU0FBUyxlQUFpQkosRUFBSTVCLEdBQzFDOUQsRUFBUUUsSUFBSTRGLFNBQVMsY0FBZ0JKLEVBQUkxQixHQUN6Q2hFLEVBQVFFLElBQUk0RixTQUFTLGVBQWlCSixFQUFJTCxHQUMxQ3JGLEVBQVFFLElBQUlDLEtBQUssR0FBSSxjQUFlLEtBQU11RixHQUFLLFlBQWEsWUFBYSx1QkFHMUVOLE9BQVFyRixTQUFVQyxRQUtyQixJQUFJK0YsTUFBT0EsUUFFWEEsTUFBS0MsTUFBTSxjQUFlLGtCQUMxQkQsS0FBS0MsTUFBTSxtQkFFWCxXQUNFLEdBQUlDLEdBQUtsRyxTQUFTbUYsY0FBYyxTQUFXZSxHQUFHQyxLQUFPLGtCQUFtQkQsRUFBR0UsT0FBUSxFQUNuRkYsRUFBR3ZDLEtBQU8sVUFBWTNELFNBQVNxRyxTQUFTQyxTQUFXLGNBQWdCLGNBQWdCLDZCQUNuRixJQUFJQyxHQUFJdkcsU0FBU3dHLHFCQUFxQixVQUFVLEVBQUlELEdBQUVFLFdBQVdDLGFBQWFSLEVBQUlLIiwiZmlsZSI6ImpzL3dpZGdldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBleHBvcnRlZCBXSURHRVRfQ09NTU9OX0NPTkZJRyAqL1xudmFyIFdJREdFVF9DT01NT05fQ09ORklHID0ge1xuICBBVVRIX1BBVEhfVVJMOiBcInYxL3dpZGdldC9hdXRoXCIsXG4gIExPR0dFUl9DTElFTlRfSUQ6IFwiMTA4ODUyNzE0NzEwOS02cTFvMnZ0aWhuMzQyOTJwanQ0Y2tobWhjazByazBvNy5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbVwiLFxuICBMT0dHRVJfQ0xJRU5UX1NFQ1JFVDogXCJubFp5cmNQTGc2b0V3TzlmOVdmbjI5V2hcIixcbiAgTE9HR0VSX1JFRlJFU0hfVE9LRU46IFwiMS94enQ0a3d6RTFIN1c5Vm5LQjhjQWFDeDZ6YjRFczRuS0VvcWFZSGRURDE1SWdPckpEdGR1bjZ6SzZYaUFUQ0tUXCIsXG4gIFNUT1JBR0VfRU5WOiBcInByb2RcIixcbiAgU1RPUkVfVVJMOiBcImh0dHBzOi8vc3RvcmUtZG90LXJ2YXNlcnZlcjIuYXBwc3BvdC5jb20vXCJcbn07XG4vKiBnbG9iYWwgV0lER0VUX0NPTU1PTl9DT05GSUcgKi9cblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24uTG9nZ2VyVXRpbHMgPSAoZnVuY3Rpb24oKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gICB2YXIgZGlzcGxheUlkID0gXCJcIixcbiAgICBjb21wYW55SWQgPSBcIlwiO1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG5cbiAgLyogUmV0cmlldmUgcGFyYW1ldGVycyB0byBwYXNzIHRvIHRoZSBldmVudCBsb2dnZXIuICovXG4gIGZ1bmN0aW9uIGdldEV2ZW50UGFyYW1zKHBhcmFtcywgY2IpIHtcbiAgICB2YXIganNvbiA9IG51bGw7XG5cbiAgICAvLyBldmVudCBpcyByZXF1aXJlZC5cbiAgICBpZiAocGFyYW1zLmV2ZW50KSB7XG4gICAgICBqc29uID0gcGFyYW1zO1xuXG4gICAgICBpZiAoanNvbi5maWxlX3VybCkge1xuICAgICAgICBqc29uLmZpbGVfZm9ybWF0ID0gZ2V0RmlsZUZvcm1hdChqc29uLmZpbGVfdXJsKTtcbiAgICAgIH1cblxuICAgICAganNvbi5jb21wYW55X2lkID0gY29tcGFueUlkO1xuICAgICAganNvbi5kaXNwbGF5X2lkID0gZGlzcGxheUlkO1xuXG4gICAgICBjYihqc29uKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBjYihqc29uKTtcbiAgICB9XG4gIH1cblxuICAvLyBHZXQgc3VmZml4IGZvciBCUSB0YWJsZSBuYW1lLlxuICBmdW5jdGlvbiBnZXRTdWZmaXgoKSB7XG4gICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpLFxuICAgICAgeWVhciA9IGRhdGUuZ2V0VVRDRnVsbFllYXIoKSxcbiAgICAgIG1vbnRoID0gZGF0ZS5nZXRVVENNb250aCgpICsgMSxcbiAgICAgIGRheSA9IGRhdGUuZ2V0VVRDRGF0ZSgpO1xuXG4gICAgaWYgKG1vbnRoIDwgMTApIHtcbiAgICAgIG1vbnRoID0gXCIwXCIgKyBtb250aDtcbiAgICB9XG5cbiAgICBpZiAoZGF5IDwgMTApIHtcbiAgICAgIGRheSA9IFwiMFwiICsgZGF5O1xuICAgIH1cblxuICAgIHJldHVybiB5ZWFyICsgbW9udGggKyBkYXk7XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGdldEZpbGVGb3JtYXQodXJsKSB7XG4gICAgdmFyIGhhc1BhcmFtcyA9IC9bPyMmXS8sXG4gICAgICBzdHI7XG5cbiAgICBpZiAoIXVybCB8fCB0eXBlb2YgdXJsICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBzdHIgPSB1cmwuc3Vic3RyKHVybC5sYXN0SW5kZXhPZihcIi5cIikgKyAxKTtcblxuICAgIC8vIGRvbid0IGluY2x1ZGUgYW55IHBhcmFtcyBhZnRlciB0aGUgZmlsZW5hbWVcbiAgICBpZiAoaGFzUGFyYW1zLnRlc3Qoc3RyKSkge1xuICAgICAgc3RyID0gc3RyLnN1YnN0cigwICwoc3RyLmluZGV4T2YoXCI/XCIpICE9PSAtMSkgPyBzdHIuaW5kZXhPZihcIj9cIikgOiBzdHIubGVuZ3RoKTtcblxuICAgICAgc3RyID0gc3RyLnN1YnN0cigwLCAoc3RyLmluZGV4T2YoXCIjXCIpICE9PSAtMSkgPyBzdHIuaW5kZXhPZihcIiNcIikgOiBzdHIubGVuZ3RoKTtcblxuICAgICAgc3RyID0gc3RyLnN1YnN0cigwLCAoc3RyLmluZGV4T2YoXCImXCIpICE9PSAtMSkgPyBzdHIuaW5kZXhPZihcIiZcIikgOiBzdHIubGVuZ3RoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3RyLnRvTG93ZXJDYXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRJbnNlcnREYXRhKHBhcmFtcykge1xuICAgIHZhciBCQVNFX0lOU0VSVF9TQ0hFTUEgPSB7XG4gICAgICBcImtpbmRcIjogXCJiaWdxdWVyeSN0YWJsZURhdGFJbnNlcnRBbGxSZXF1ZXN0XCIsXG4gICAgICBcInNraXBJbnZhbGlkUm93c1wiOiBmYWxzZSxcbiAgICAgIFwiaWdub3JlVW5rbm93blZhbHVlc1wiOiBmYWxzZSxcbiAgICAgIFwidGVtcGxhdGVTdWZmaXhcIjogZ2V0U3VmZml4KCksXG4gICAgICBcInJvd3NcIjogW3tcbiAgICAgICAgXCJpbnNlcnRJZFwiOiBcIlwiXG4gICAgICB9XVxuICAgIH0sXG4gICAgZGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoQkFTRV9JTlNFUlRfU0NIRU1BKSk7XG5cbiAgICBkYXRhLnJvd3NbMF0uaW5zZXJ0SWQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMikudG9VcHBlckNhc2UoKTtcbiAgICBkYXRhLnJvd3NbMF0uanNvbiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocGFyYW1zKSk7XG4gICAgZGF0YS5yb3dzWzBdLmpzb24udHMgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG5cbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGxvZ0V2ZW50KHRhYmxlLCBwYXJhbXMpIHtcbiAgICBnZXRFdmVudFBhcmFtcyhwYXJhbXMsIGZ1bmN0aW9uKGpzb24pIHtcbiAgICAgIGlmIChqc29uICE9PSBudWxsKSB7XG4gICAgICAgIFJpc2VWaXNpb24uQ29tbW9uLkxvZ2dlci5sb2codGFibGUsIGpzb24pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyogU2V0IHRoZSBDb21wYW55IGFuZCBEaXNwbGF5IElEcy4gKi9cbiAgZnVuY3Rpb24gc2V0SWRzKGNvbXBhbnksIGRpc3BsYXkpIHtcbiAgICBjb21wYW55SWQgPSBjb21wYW55O1xuICAgIGRpc3BsYXlJZCA9IGRpc3BsYXk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwiZ2V0SW5zZXJ0RGF0YVwiOiBnZXRJbnNlcnREYXRhLFxuICAgIFwiZ2V0RmlsZUZvcm1hdFwiOiBnZXRGaWxlRm9ybWF0LFxuICAgIFwibG9nRXZlbnRcIjogbG9nRXZlbnQsXG4gICAgXCJzZXRJZHNcIjogc2V0SWRzXG4gIH07XG59KSgpO1xuXG5SaXNlVmlzaW9uLkNvbW1vbi5Mb2dnZXIgPSAoZnVuY3Rpb24odXRpbHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIFJFRlJFU0hfVVJMID0gXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjMvdG9rZW4/Y2xpZW50X2lkPVwiICsgV0lER0VUX0NPTU1PTl9DT05GSUcuTE9HR0VSX0NMSUVOVF9JRCArXG4gICAgICBcIiZjbGllbnRfc2VjcmV0PVwiICsgV0lER0VUX0NPTU1PTl9DT05GSUcuTE9HR0VSX0NMSUVOVF9TRUNSRVQgK1xuICAgICAgXCImcmVmcmVzaF90b2tlbj1cIiArIFdJREdFVF9DT01NT05fQ09ORklHLkxPR0dFUl9SRUZSRVNIX1RPS0VOICtcbiAgICAgIFwiJmdyYW50X3R5cGU9cmVmcmVzaF90b2tlblwiO1xuXG4gIHZhciBzZXJ2aWNlVXJsID0gXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9iaWdxdWVyeS92Mi9wcm9qZWN0cy9jbGllbnQtc2lkZS1ldmVudHMvZGF0YXNldHMvV2lkZ2V0X0V2ZW50cy90YWJsZXMvVEFCTEVfSUQvaW5zZXJ0QWxsXCIsXG4gICAgdGhyb3R0bGUgPSBmYWxzZSxcbiAgICB0aHJvdHRsZURlbGF5ID0gMTAwMCxcbiAgICBsYXN0RXZlbnQgPSBcIlwiLFxuICAgIHJlZnJlc2hEYXRlID0gMCxcbiAgICB0b2tlbiA9IFwiXCI7XG5cbiAgLypcbiAgICogIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gcmVmcmVzaFRva2VuKGNiKSB7XG4gICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXG4gICAgaWYgKG5ldyBEYXRlKCkgLSByZWZyZXNoRGF0ZSA8IDM1ODAwMDApIHtcbiAgICAgIHJldHVybiBjYih7fSk7XG4gICAgfVxuXG4gICAgeGhyLm9wZW4oXCJQT1NUXCIsIFJFRlJFU0hfVVJMLCB0cnVlKTtcbiAgICB4aHIub25sb2FkZW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcmVzcCA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlKTtcblxuICAgICAgY2IoeyB0b2tlbjogcmVzcC5hY2Nlc3NfdG9rZW4sIHJlZnJlc2hlZEF0OiBuZXcgRGF0ZSgpIH0pO1xuICAgIH07XG5cbiAgICB4aHIuc2VuZCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNUaHJvdHRsZWQoZXZlbnQpIHtcbiAgICByZXR1cm4gdGhyb3R0bGUgJiYgKGxhc3RFdmVudCA9PT0gZXZlbnQpO1xuICB9XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBsb2codGFibGVOYW1lLCBwYXJhbXMpIHtcbiAgICBpZiAoIXRhYmxlTmFtZSB8fCAhcGFyYW1zIHx8IChwYXJhbXMuaGFzT3duUHJvcGVydHkoXCJldmVudFwiKSAmJiAhcGFyYW1zLmV2ZW50KSB8fFxuICAgICAgKHBhcmFtcy5oYXNPd25Qcm9wZXJ0eShcImV2ZW50XCIpICYmIGlzVGhyb3R0bGVkKHBhcmFtcy5ldmVudCkpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhyb3R0bGUgPSB0cnVlO1xuICAgIGxhc3RFdmVudCA9IHBhcmFtcy5ldmVudDtcblxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgdGhyb3R0bGUgPSBmYWxzZTtcbiAgICB9LCB0aHJvdHRsZURlbGF5KTtcblxuICAgIGZ1bmN0aW9uIGluc2VydFdpdGhUb2tlbihyZWZyZXNoRGF0YSkge1xuICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpLFxuICAgICAgICBpbnNlcnREYXRhLCB1cmw7XG5cbiAgICAgIHVybCA9IHNlcnZpY2VVcmwucmVwbGFjZShcIlRBQkxFX0lEXCIsIHRhYmxlTmFtZSk7XG4gICAgICByZWZyZXNoRGF0ZSA9IHJlZnJlc2hEYXRhLnJlZnJlc2hlZEF0IHx8IHJlZnJlc2hEYXRlO1xuICAgICAgdG9rZW4gPSByZWZyZXNoRGF0YS50b2tlbiB8fCB0b2tlbjtcbiAgICAgIGluc2VydERhdGEgPSB1dGlscy5nZXRJbnNlcnREYXRhKHBhcmFtcyk7XG5cbiAgICAgIC8vIEluc2VydCB0aGUgZGF0YS5cbiAgICAgIHhoci5vcGVuKFwiUE9TVFwiLCB1cmwsIHRydWUpO1xuICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xuICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJBdXRob3JpemF0aW9uXCIsIFwiQmVhcmVyIFwiICsgdG9rZW4pO1xuXG4gICAgICBpZiAocGFyYW1zLmNiICYmIHR5cGVvZiBwYXJhbXMuY2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB4aHIub25sb2FkZW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcGFyYW1zLmNiKHhoci5yZXNwb25zZSk7XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHhoci5zZW5kKEpTT04uc3RyaW5naWZ5KGluc2VydERhdGEpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVmcmVzaFRva2VuKGluc2VydFdpdGhUb2tlbik7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwibG9nXCI6IGxvZ1xuICB9O1xufSkoUmlzZVZpc2lvbi5Db21tb24uTG9nZ2VyVXRpbHMpO1xuLyogZXhwb3J0ZWQgY29uZmlnICovXG5pZiAodHlwZW9mIGFuZ3VsYXIgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgYW5ndWxhci5tb2R1bGUoXCJyaXNldmlzaW9uLmNvbW1vbi5pMThuLmNvbmZpZ1wiLCBbXSlcbiAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1BSRUZJWFwiLCBcImxvY2FsZXMvdHJhbnNsYXRpb25fXCIpXG4gICAgLmNvbnN0YW50KFwiTE9DQUxFU19TVUZJWFwiLCBcIi5qc29uXCIpO1xufVxuXG52YXIgY29uZmlnID0ge1xuICBTVE9SQUdFX0VOVjogXCJwcm9kXCJcbn07XG5cbi8qIGdsb2JhbCBnYWRnZXRzICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uV2ViUGFnZSA9IHt9O1xuXG5SaXNlVmlzaW9uLldlYlBhZ2UgPSAoZnVuY3Rpb24gKGRvY3VtZW50LCBnYWRnZXRzKSB7XG5cbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgLy8gcHJpdmF0ZSB2YXJpYWJsZXNcbiAgdmFyIF9wcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCksXG4gICAgX2FkZGl0aW9uYWxQYXJhbXMgPSBudWxsLFxuICAgIF91cmwgPSBcIlwiLFxuICAgIF92ZXJ0aWNhbCA9IDAsXG4gICAgX2ludGVydmFsSWQgPSBudWxsO1xuXG4gIHZhciBfbWVzc2FnZSA9IG51bGw7XG5cbiAgLypcbiAgICogIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX3JlYWR5KCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X3JlYWR5XCIsIG51bGwsIF9wcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSxcbiAgICAgIHRydWUsIHRydWUsIHRydWUsIHRydWUsIGZhbHNlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF92YWxpZGF0ZVVybChjYikge1xuICAgIHZhciBwcm94eVVybCA9IFwiaHR0cHM6Ly9wcm94eS5yaXNldmlzaW9uLmNvbS9cIiArIF91cmwsXG4gICAgICByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICBmdW5jdGlvbiBoYW5kbGVQcm94eVJlc3BvbnNlKGUpIHtcbiAgICAgIHZhciBzdWNjZXNzID0gdHJ1ZSxcbiAgICAgICAgaGVhZGVyID0gZS50YXJnZXQuZ2V0UmVzcG9uc2VIZWFkZXIoXCJYLUZyYW1lLU9wdGlvbnNcIik7XG5cbiAgICAgIGlmIChoZWFkZXIgJiYgKGhlYWRlci50b1VwcGVyQ2FzZSgpID09PSBcIlNBTUVPUklHSU5cIikpIHtcbiAgICAgICAgbG9nRXZlbnQoe1xuICAgICAgICAgIFwiZXZlbnRcIjogXCJlcnJvclwiLFxuICAgICAgICAgIFwiZXZlbnRfZGV0YWlsc1wiOiBcIlgtRnJhbWUtT3B0aW9ucyBoZWFkZXJcIixcbiAgICAgICAgICBcImVycm9yX2RldGFpbHNcIjogXCJTQU1FT1JJR0lOXCIsXG4gICAgICAgICAgXCJ1cmxcIjogX3VybFxuICAgICAgICB9KTtcblxuICAgICAgICBfbWVzc2FnZS5zaG93KFwiVGhlIG93bmVyIG9mIHRoZSBXZWIgUGFnZSBhdCB0aGUgVVJMIHByb3ZpZGVkIGRvZXMgbm90IGFsbG93IHRoZSBQYWdlIHRvIFwiICtcbiAgICAgICAgICBcImJlIGVtYmVkZGVkIHdpdGhpbiBhbiBpRnJhbWUuIElmIHBvc3NpYmxlLCBwbGVhc2UgY29udGFjdCB0aGUgV2ViIFBhZ2Ugb3duZXIgdG8gXCIgK1xuICAgICAgICAgIFwiZGlzY3VzcyBYLUZyYW1lLU9wdGlvbnMuXCIpO1xuXG4gICAgICAgIHN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNiICYmICh0eXBlb2YgY2IgPT09IFwiZnVuY3Rpb25cIikpIHtcbiAgICAgICAgY2Ioc3VjY2Vzcyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBoYW5kbGVQcm94eVJlc3BvbnNlKTtcbiAgICByZXF1ZXN0Lm9wZW4oXCJHRVRcIiwgcHJveHlVcmwpO1xuICAgIHJlcXVlc3Quc2VuZCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gX3NldEludGVyYWN0aXZpdHkoKSB7XG4gICAgdmFyIGZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3ZWJwYWdlLWZyYW1lXCIpLFxuICAgICAgYmxvY2tlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYmxvY2tlclwiKTtcblxuICAgIGJsb2NrZXIuc3R5bGUuZGlzcGxheSA9IChfYWRkaXRpb25hbFBhcmFtcy5pbnRlcmFjdGl2aXR5LmludGVyYWN0aXZlKSA/IFwibm9uZVwiIDogXCJibG9ja1wiO1xuXG4gICAgZnJhbWUuc2V0QXR0cmlidXRlKFwic2Nyb2xsaW5nXCIsXG4gICAgICAoX2FkZGl0aW9uYWxQYXJhbXMuaW50ZXJhY3Rpdml0eS5pbnRlcmFjdGl2ZSAmJiBfYWRkaXRpb25hbFBhcmFtcy5pbnRlcmFjdGl2aXR5LnNjcm9sbGJhcnMpID8gXCJ5ZXNcIiA6IFwibm9cIik7XG4gIH1cblxuICBmdW5jdGlvbiBfY29uZmlndXJlUGFnZSgpIHtcbiAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb250YWluZXJcIiksXG4gICAgICBmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2VicGFnZS1mcmFtZVwiKSxcbiAgICAgIGFzcGVjdFJhdGlvID0gIChfcHJlZnMuZ2V0SW50KFwicnNIXCIpIC8gX3ByZWZzLmdldEludChcInJzV1wiKSkgKiAxMDA7XG5cbiAgICBpZiAoY29udGFpbmVyICYmIGZyYW1lKSB7XG4gICAgICAvLyBIaWRpbmcgaWZyYW1lIGNvbnRhaW5lciwgdmlzaWJsZSB3aGVuIHRoZSBpZnJhbWUgc3VjY2Vzc2Z1bGx5IGxvYWRzXG4gICAgICBjb250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XG5cbiAgICAgIF9zZXRJbnRlcmFjdGl2aXR5KCk7XG4gICAgICBfc2V0UmVnaW9uKGZyYW1lKTtcbiAgICAgIF9zZXRab29tKGZyYW1lKTtcblxuICAgICAgLy8gaW1wbGVtZW50IHJlc3BvbnNpdmUgaWZyYW1lXG4gICAgICBpZiAoX3ZlcnRpY2FsICE9PSAwKSB7XG4gICAgICAgIGFzcGVjdFJhdGlvICs9IChfdmVydGljYWwgLyBfcHJlZnMuZ2V0SW50KFwicnNXXCIpKSAqIDEwMDtcbiAgICAgIH1cblxuICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwicGFkZGluZy1ib3R0b206XCIgKyBhc3BlY3RSYXRpbyArIFwiJVwiKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBfc2V0Wm9vbShmcmFtZSkge1xuICAgdmFyIHpvb20gPSBwYXJzZUZsb2F0KF9hZGRpdGlvbmFsUGFyYW1zLnpvb20pLFxuICAgICB6b29tU3R5bGU7XG5cbiAgICAvLyBDb25maWd1cmUgdGhlIHpvb20gKHNjYWxlKSBzdHlsaW5nXG4gICAgem9vbVN0eWxlID0gXCItbXMtem9vbTpcIiArIHpvb20gKyBcIjtcIiArXG4gICAgICBcIi1tb3otdHJhbnNmb3JtOiBzY2FsZShcIiArIHpvb20gKyBcIik7XCIgK1xuICAgICAgXCItbW96LXRyYW5zZm9ybS1vcmlnaW46IDAgMDtcIiArXG4gICAgICBcIi1vLXRyYW5zZm9ybTogc2NhbGUoXCIgKyB6b29tICsgXCIpO1wiICtcbiAgICAgIFwiLW8tdHJhbnNmb3JtLW9yaWdpbjogMCAwO1wiICtcbiAgICAgIFwiLXdlYmtpdC10cmFuc2Zvcm06IHNjYWxlKFwiICsgem9vbSArIFwiKTtcIiArXG4gICAgICBcIi13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjogMCAwO1wiICtcbiAgICAgIFwidHJhbnNmb3JtOiBzY2FsZShcIiArIHpvb20gKyBcIik7XCIgK1xuICAgICAgXCJ0cmFuc2Zvcm0tb3JpZ2luOiAwIDA7XCI7XG5cbiAgICB6b29tU3R5bGUgKz0gXCJ3aWR0aDogXCIgKyAoKDEgLyB6b29tKSAqIDEwMCkgKyBcIiU7XCIgK1xuICAgICAgXCJoZWlnaHQ6IFwiICsgKCgxIC8gem9vbSkgKiAxMDApICsgXCIlO1wiO1xuXG4gICAgdmFyIGN1cnJlbnRTdHlsZSA9IGZyYW1lLmdldEF0dHJpYnV0ZShcInN0eWxlXCIpO1xuICAgIGlmIChjdXJyZW50U3R5bGUpIHtcbiAgICAgIHpvb21TdHlsZSA9IGN1cnJlbnRTdHlsZSArIHpvb21TdHlsZTtcbiAgICB9XG5cbiAgICBmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCB6b29tU3R5bGUpO1xuICB9XG5cbiAgZnVuY3Rpb24gX3NldFJlZ2lvbihmcmFtZSkge1xuICAgIHZhciBtYXJnaW5TdHlsZSA9IFwiXCIsXG4gICAgICBob3Jpem9udGFsID0gMDtcblxuICAgIGlmIChfYWRkaXRpb25hbFBhcmFtcy5yZWdpb24gJiYgX2FkZGl0aW9uYWxQYXJhbXMucmVnaW9uLnNob3dSZWdpb24gJiZcbiAgICAgIChfYWRkaXRpb25hbFBhcmFtcy5yZWdpb24uc2hvd1JlZ2lvbiA9PT0gXCJyZWdpb25cIikpIHtcbiAgICAgIGlmIChfYWRkaXRpb25hbFBhcmFtcy5yZWdpb24uaG9yaXpvbnRhbCA+IDApIHtcbiAgICAgICAgaG9yaXpvbnRhbCA9IF9hZGRpdGlvbmFsUGFyYW1zLnJlZ2lvbi5ob3Jpem9udGFsO1xuICAgICAgfVxuXG4gICAgICBpZiAoX2FkZGl0aW9uYWxQYXJhbXMucmVnaW9uLnZlcnRpY2FsID4gMCkge1xuICAgICAgICBfdmVydGljYWwgPSBfYWRkaXRpb25hbFBhcmFtcy5yZWdpb24udmVydGljYWw7XG4gICAgICB9XG5cbiAgICAgIC8vIEFwcGx5IG5lZ2F0aXZlIG1hcmdpbnMgaW4gb3JkZXIgdG8gc2hvdyBhIHJlZ2lvbi5cbiAgICAgIGlmICgoaG9yaXpvbnRhbCAhPT0gMCkgfHwgKF92ZXJ0aWNhbCAhPT0gMCkpIHtcbiAgICAgICAgbWFyZ2luU3R5bGUgPSBcIm1hcmdpbjogXCIgKyBcIi1cIiArIF92ZXJ0aWNhbCArIFwicHggMCAwIC1cIiArIGhvcml6b250YWwgKyBcInB4O1wiO1xuXG4gICAgICAgIHZhciBjdXJyZW50U3R5bGUgPSBmcmFtZS5nZXRBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcbiAgICAgICAgaWYgKGN1cnJlbnRTdHlsZSkge1xuICAgICAgICAgIG1hcmdpblN0eWxlID0gY3VycmVudFN0eWxlICsgbWFyZ2luU3R5bGU7XG4gICAgICAgIH1cblxuICAgICAgICBmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBtYXJnaW5TdHlsZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gX3N0YXJ0UmVmcmVzaEludGVydmFsKCkge1xuICAgIF9pbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgLy8gY2FsbCBwdWJsaWMgZnVuY3Rpb24gZm9yIGludGVncmF0aW9uIHRlc3RpbmcgcHVycG9zZXNcbiAgICAgIF9sb2FkRnJhbWUoKTtcbiAgICB9LCBfYWRkaXRpb25hbFBhcmFtcy5yZWZyZXNoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9sb2FkRnJhbWUoKSB7XG4gICAgdmFyIGZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3ZWJwYWdlLWZyYW1lXCIpLFxuICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb250YWluZXJcIik7XG5cbiAgICBpZiAoY29udGFpbmVyICYmIGZyYW1lKSB7XG4gICAgICBmcmFtZS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZyYW1lLm9ubG9hZCA9IG51bGw7XG5cbiAgICAgICAgLy8gU2hvdyB0aGUgaWZyYW1lIGNvbnRhaW5lclxuICAgICAgICBjb250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9IFwidmlzaWJsZVwiO1xuXG4gICAgICAgIC8vIGNoZWNrIGlmIHJlZnJlc2ggaW50ZXJ2YWwgc2hvdWxkIGJlIHN0YXJ0ZWRcbiAgICAgICAgaWYgKF9hZGRpdGlvbmFsUGFyYW1zLnJlZnJlc2ggPiAwICYmIF9pbnRlcnZhbElkID09PSBudWxsKSB7XG4gICAgICAgICAgX3N0YXJ0UmVmcmVzaEludGVydmFsKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGZyYW1lLnNldEF0dHJpYnV0ZShcInNyY1wiLCBfdXJsKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBfdW5sb2FkRnJhbWUoKSB7XG4gICAgdmFyIGZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3ZWJwYWdlLWZyYW1lXCIpO1xuXG4gICAgaWYgKF9hZGRpdGlvbmFsUGFyYW1zLnJlZnJlc2ggPiAwKSB7XG4gICAgICBjbGVhckludGVydmFsKF9pbnRlcnZhbElkKTtcbiAgICB9XG5cbiAgICBpZiAoZnJhbWUpIHtcbiAgICAgIGZyYW1lLnNyYyA9IFwiYWJvdXQ6YmxhbmtcIjtcbiAgICB9XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIF9pbml0KCkge1xuICAgIF9tZXNzYWdlID0gbmV3IFJpc2VWaXNpb24uQ29tbW9uLk1lc3NhZ2UoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb250YWluZXJcIiksXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1lc3NhZ2VDb250YWluZXJcIikpO1xuXG4gICAgLy8gQ29uZmlndXJlIHRoZSB2YWx1ZSBmb3IgX3VybFxuICAgIF91cmwgPSBfYWRkaXRpb25hbFBhcmFtcy51cmw7XG5cbiAgICAvLyBBZGQgaHR0cDovLyBpZiBubyBwcm90b2NvbCBwYXJhbWV0ZXIgZXhpc3RzXG4gICAgaWYgKF91cmwuaW5kZXhPZihcIjovL1wiKSA9PT0gLTEpIHtcbiAgICAgIF91cmwgPSBcImh0dHA6Ly9cIiArIF91cmw7XG4gICAgfVxuXG4gICAgX3ZhbGlkYXRlVXJsKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICAgIF9jb25maWd1cmVQYWdlKCk7XG4gICAgICB9XG5cbiAgICAgIF9yZWFkeSgpO1xuICAgIH0pO1xuICB9XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBnZXRUYWJsZU5hbWUoKSB7XG4gICAgcmV0dXJuIFwid2VicGFnZV9ldmVudHNcIjtcbiAgfVxuXG4gIGZ1bmN0aW9uIGxvZ0V2ZW50KHBhcmFtcykge1xuICAgIFJpc2VWaXNpb24uQ29tbW9uLkxvZ2dlclV0aWxzLmxvZ0V2ZW50KGdldFRhYmxlTmFtZSgpLCBwYXJhbXMpO1xuICB9XG5cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgX3VubG9hZEZyYW1lKCk7XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAgIF9sb2FkRnJhbWUoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgcGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldEFkZGl0aW9uYWxQYXJhbXMoYWRkaXRpb25hbFBhcmFtcykge1xuICAgIF9hZGRpdGlvbmFsUGFyYW1zID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhZGRpdGlvbmFsUGFyYW1zKSk7XG5cbiAgICBfaW5pdCgpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImdldFRhYmxlTmFtZVwiOiBnZXRUYWJsZU5hbWUsXG4gICAgXCJsb2dFdmVudFwiOiBsb2dFdmVudCxcbiAgICBcInNldEFkZGl0aW9uYWxQYXJhbXNcIjogc2V0QWRkaXRpb25hbFBhcmFtcyxcbiAgICBcInBhdXNlXCI6IHBhdXNlLFxuICAgIFwicGxheVwiOiBwbGF5LFxuICAgIFwic3RvcFwiOiBzdG9wXG4gIH07XG5cbn0pKGRvY3VtZW50LCBnYWRnZXRzKTtcblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24uTWVzc2FnZSA9IGZ1bmN0aW9uIChtYWluQ29udGFpbmVyLCBtZXNzYWdlQ29udGFpbmVyKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfYWN0aXZlID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gX2luaXQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gbWFpbkNvbnRhaW5lci5zdHlsZS5oZWlnaHQ7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS53YXJuKFwiQ2FuJ3QgaW5pdGlhbGl6ZSBNZXNzYWdlIC0gXCIsIGUubWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBoaWRlKCkge1xuICAgIGlmIChfYWN0aXZlKSB7XG4gICAgICAvLyBjbGVhciBjb250ZW50IG9mIG1lc3NhZ2UgY29udGFpbmVyXG4gICAgICB3aGlsZSAobWVzc2FnZUNvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgIG1lc3NhZ2VDb250YWluZXIucmVtb3ZlQ2hpbGQobWVzc2FnZUNvbnRhaW5lci5maXJzdENoaWxkKTtcbiAgICAgIH1cblxuICAgICAgLy8gaGlkZSBtZXNzYWdlIGNvbnRhaW5lclxuICAgICAgbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbiAgICAgIC8vIHNob3cgbWFpbiBjb250YWluZXJcbiAgICAgIG1haW5Db250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9IFwidmlzaWJsZVwiO1xuXG4gICAgICBfYWN0aXZlID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gc2hvdyhtZXNzYWdlKSB7XG4gICAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLFxuICAgICAgcDtcblxuICAgIGlmICghX2FjdGl2ZSkge1xuICAgICAgLy8gaGlkZSBtYWluIGNvbnRhaW5lclxuICAgICAgbWFpbkNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcblxuICAgICAgbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuXG4gICAgICAvLyBjcmVhdGUgbWVzc2FnZSBlbGVtZW50XG4gICAgICBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gICAgICBwLmlubmVySFRNTCA9IG1lc3NhZ2U7XG4gICAgICBwLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibWVzc2FnZVwiKTtcblxuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQocCk7XG4gICAgICBtZXNzYWdlQ29udGFpbmVyLmFwcGVuZENoaWxkKGZyYWdtZW50KTtcblxuICAgICAgX2FjdGl2ZSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIG1lc3NhZ2UgYWxyZWFkeSBiZWluZyBzaG93biwgdXBkYXRlIG1lc3NhZ2UgdGV4dFxuICAgICAgcCA9IG1lc3NhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5tZXNzYWdlXCIpO1xuICAgICAgcC5pbm5lckhUTUwgPSBtZXNzYWdlO1xuICAgIH1cbiAgfVxuXG4gIF9pbml0KCk7XG5cbiAgcmV0dXJuIHtcbiAgICBcImhpZGVcIjogaGlkZSxcbiAgICBcInNob3dcIjogc2hvd1xuICB9O1xufTtcblxuLyogZ2xvYmFsIFJpc2VWaXNpb24sIGdhZGdldHMgKi9cblxuKGZ1bmN0aW9uICh3aW5kb3csIGRvY3VtZW50LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBpZCA9IG5ldyBnYWRnZXRzLlByZWZzKCkuZ2V0U3RyaW5nKFwiaWRcIik7XG5cbiAgLy8gRGlzYWJsZSBjb250ZXh0IG1lbnUgKHJpZ2h0IGNsaWNrIG1lbnUpXG4gIHdpbmRvdy5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBkb2N1bWVudC5ib2R5Lm9ubW91c2Vkb3duID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyZShuYW1lcywgdmFsdWVzKSB7XG4gICAgdmFyIGFkZGl0aW9uYWxQYXJhbXMsXG4gICAgICBjb21wYW55SWQgPSBcIlwiLFxuICAgICAgZGlzcGxheUlkID0gXCJcIjtcblxuICAgIGlmIChBcnJheS5pc0FycmF5KG5hbWVzKSAmJiBuYW1lcy5sZW5ndGggPiAwICYmIEFycmF5LmlzQXJyYXkodmFsdWVzKSAmJiB2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgLy8gY29tcGFueSBpZFxuICAgICAgaWYgKG5hbWVzWzBdID09PSBcImNvbXBhbnlJZFwiKSB7XG4gICAgICAgIGNvbXBhbnlJZCA9IHZhbHVlc1swXTtcbiAgICAgIH1cblxuICAgICAgLy8gZGlzcGxheSBpZFxuICAgICAgaWYgKG5hbWVzWzFdID09PSBcImRpc3BsYXlJZFwiKSB7XG4gICAgICAgIGlmICh2YWx1ZXNbMV0pIHtcbiAgICAgICAgICBkaXNwbGF5SWQgPSB2YWx1ZXNbMV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgZGlzcGxheUlkID0gXCJwcmV2aWV3XCI7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gcHJvdmlkZSBMb2dnZXJVdGlscyB0aGUgaWRzIHRvIHVzZVxuICAgICAgUmlzZVZpc2lvbi5Db21tb24uTG9nZ2VyVXRpbHMuc2V0SWRzKGNvbXBhbnlJZCwgZGlzcGxheUlkKTtcblxuICAgICAgLy8gYWRkaXRpb25hbCBwYXJhbXNcbiAgICAgIGlmIChuYW1lc1syXSA9PT0gXCJhZGRpdGlvbmFsUGFyYW1zXCIpIHtcbiAgICAgICAgYWRkaXRpb25hbFBhcmFtcyA9IEpTT04ucGFyc2UodmFsdWVzWzJdKTtcblxuICAgICAgICBSaXNlVmlzaW9uLldlYlBhZ2Uuc2V0QWRkaXRpb25hbFBhcmFtcyhhZGRpdGlvbmFsUGFyYW1zKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAgIFJpc2VWaXNpb24uV2ViUGFnZS5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBSaXNlVmlzaW9uLldlYlBhZ2UucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgUmlzZVZpc2lvbi5XZWJQYWdlLnN0b3AoKTtcbiAgfVxuXG4gIGlmIChpZCAmJiBpZCAhPT0gXCJcIikge1xuICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGxheV9cIiArIGlkLCBwbGF5KTtcbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BhdXNlX1wiICsgaWQsIHBhdXNlKTtcbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3N0b3BfXCIgKyBpZCwgc3RvcCk7XG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc3BhcmFtX3NldF9cIiArIGlkLCBjb25maWd1cmUpO1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc3BhcmFtX2dldFwiLCBudWxsLCBpZCwgW1wiY29tcGFueUlkXCIsIFwiZGlzcGxheUlkXCIsIFwiYWRkaXRpb25hbFBhcmFtc1wiXSk7XG4gIH1cblxufSkod2luZG93LCBkb2N1bWVudCwgZ2FkZ2V0cyk7XG5cblxuXG4vKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovXG52YXIgX2dhcSA9IF9nYXEgfHwgW107XG5cbl9nYXEucHVzaChbJ19zZXRBY2NvdW50JywgJ1VBLTU3MDkyMTU5LTYnXSk7XG5fZ2FxLnB1c2goWydfdHJhY2tQYWdldmlldyddKTtcblxuKGZ1bmN0aW9uKCkge1xuICB2YXIgZ2EgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsgZ2EudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnOyBnYS5hc3luYyA9IHRydWU7XG4gIGdhLnNyYyA9ICgnaHR0cHM6JyA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCA/ICdodHRwczovL3NzbCcgOiAnaHR0cDovL3d3dycpICsgJy5nb29nbGUtYW5hbHl0aWNzLmNvbS9nYS5qcyc7XG4gIHZhciBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdOyBzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGdhLCBzKTtcbn0pKCk7XG4vKiBqc2hpbnQgaWdub3JlOmVuZCAqL1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
